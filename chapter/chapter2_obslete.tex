\chapter{Lagrange动力学}

1788年，Lagrange发表名著《分析力学》。全书无图，藉助数学分析建立运动方程。

\section{约束与广义坐标}

\subsection{约束及其分类}

在质点系的运动过程中，各质点的位置和速度受到的限制称为{\heiti 约束}。如果系统不受约束，则称系统是{\bf 自由的}或者为{\bf 自由系统}，相应地，如果系统受到一个或更多约束的作用，则称系统是{\bf 非自由的}。

如果系统中各质点的位矢为$\mbf{r}_i\,(i=1,2,\cdots,n)$，那么各质点的速度可以表示为$\dot{\mbf{r}}\,(i=1,2,\cdots,n)$，约束可以用方程表示为
\begin{equation}
	f(\mbf{r}_1,\mbf{r}_2,\cdots,\mbf{r}_n;\dot{\mbf{r}}_1,\dot{\mbf{r}}_2,\cdots,\dot{\mbf{r}}_n;t) = 0
	\label{约束方程}
\end{equation}
或者
\begin{equation}
	f(\mbf{r}_1,\mbf{r}_2,\cdots,\mbf{r}_n;\dot{\mbf{r}}_1,\dot{\mbf{r}}_2,\cdots,\dot{\mbf{r}}_n;t) \geqslant 0
	\label{单面约束方程}
\end{equation}
类似式\eqref{约束方程}只有等号成立的约束称为{\bf 双面约束}，而类似式\eqref{单面约束方程}等号和不等号都可以成立的约束称为{\bf 单面约束}。

约束可以按其是否与质点的速度有关而分为以下两类：
\begin{enumerate}
	\item {\heiti 几何约束}：约束与速度无关，仅对几何位形加以限制。即
	\begin{equation}
		f(\mbf{r}_1,\mbf{r}_2,\cdots,\mbf{r}_n;t) = 0
	\end{equation}
	一个几何约束减少一个独立坐标与一个独立速度分量。例如，单摆（如图\ref{单摆的几何约束}所示）的约束可以表示为
	\begin{equation*}
		|\mbf{r}|^2-l^2 = x^2+y^2-l^2 = 0
	\end{equation*}
\begin{figure}[htb]
\centering
\begin{minipage}[t]{0.45\textwidth}
\begin{asy}
	size(200);
	//单摆的几何约束
	pair O,x,y,r;
	O = (0,0);
	x = (4,0);
	y = (0,-4.5);
	r = (3,-4);
	draw(Label("$x$",EndPoint),O--x,Arrow);
	draw(Label("$y$",EndPoint),O--y,Arrow);
	label("$O$",O,W);
	filldraw(shift(r)*scale(0.2)*unitcircle,yellow,black);
	draw(Label("$\boldsymbol{r}$",MidPoint,Relative(E)),O--r,Arrow);
	draw(Label("$l$",MidPoint,Relative(W)),O--r,Arrow);
	//draw(O--(4.5,0),invisible);
\end{asy}
\caption{单摆的几何约束}
\label{单摆的几何约束}
\end{minipage}
\hspace{0.5cm}
\begin{minipage}[t]{0.45\textwidth}
\begin{asy}
	size(200);
	//纯滚动直立圆盘
	real hd,hdd;
	pair O,x,y,z,i,j,k;
	hd = 131+25/60;
	hdd = 7+10/60;
	O = (0,0);
	x = 1.2*dir(90+hd);
	y = 1.5*dir(-hdd);
	z = 1.5*dir(90);
	draw(Label("$x$",EndPoint),O--x,Arrow);
	draw(Label("$y$",EndPoint),O--y,Arrow);
	draw(Label("$z$",EndPoint),O--z,Arrow);
	label("$O$",O,NW);
	i = (-sqrt(2)/4,-sqrt(14)/12);
	j = (sqrt(14)/4,-sqrt(2)/12);
	k = (0,2*sqrt(2)/3);
	
	real x0,y0,r,phi;
	pair P;
	pair planecur(real xx){
		real yy = y0+1*tan(xx-x0);
		return xx*i+yy*j;
	}
	pair dplanecur(real xx){
		real yy = 1/((cos(xx-x0))**2);
		return xx*i+yy*j;
	}
	pair wheel(real theta){
		real xx,yy,zz;
		xx = x0+r*sin(theta)*cos(phi);
		yy = y0+r*sin(theta)*sin(phi);
		zz = r+r*cos(theta);
		return xx*i+yy*j+zz*k;
	}
	real getphi(real xx){
		real yy = 1/((cos(xx-x0))**2);
		return atan(yy/xx);
	}
	x0 = 1;
	y0 = 0.7;
	r = 0.5;
	phi = getphi(x0);
	unfill(graph(wheel,0,2*pi)--cycle);
	draw(graph(wheel,0,2*pi),linewidth(0.8bp));
	draw(graph(planecur,x0-1,x0+1));
	P = planecur(x0);
	dot(P);
	draw((P-0.7*dplanecur(x0))--(P+dplanecur(x0)),dashed);
	draw(P--P+r*k--wheel(-1.2));
	label("$(x,y)$",P+r*k,E);
	label("$\theta$",P+r*k,WSW);
	label("$\phi$",P-0.7*dplanecur(x0),2*S);
	
	//draw(O--(1.7,0),invisible);
\end{asy}
\caption{作曲线运动的纯滚动直立圆盘}
\label{作曲线运动的纯滚动直立圆盘}
\end{minipage}
\end{figure}
	\item {\heiti 运动约束}：约束与速度有关，同时对系统的几何位形和运动情况加以限制。运动约束条件不减少独立坐标个数，但每个运动约束减少一个独立速度分量。例如，作曲线运动的纯滚动直立圆盘（如图\ref{作曲线运动的纯滚动直立圆盘}所示）的约束可以表示为
	\begin{equation*}
		\begin{cases}
			\dot{x} - R\dot{\theta}\cos \phi = 0 \\
			\dot{y} - R\dot{\theta}\sin \phi = 0
		\end{cases}
	\end{equation*}
	圆盘可由任一指定初位形出发，到达任一指定末位形。但如果圆盘作直线运动，此时$\phi = \phi_0\text{（常数）}$，则运动约束可积\footnote{在求解运动前。}（此时即称为{\heiti 可积运动约束}），即
	\begin{equation*}
		\begin{cases}
			x - R\theta\cos \phi_0 + C_1 = 0 \\
			y - R\theta\sin \phi_0 + C_2 = 0
		\end{cases}
	\end{equation*}
	可积运动约束实质上等价于几何约束。
\end{enumerate}

几何约束与可积运动约束称为{\heiti 完整约束}，一个完整约束方程同时减少一个独立坐标与一个独立速度分量。不可积运动约束则称为{\heiti 非完整约束}，一个非完整约束方程只减少一个独立速度分量。如果一个系统的所有约束皆为完整约束，则该系统称为{\heiti 完整系统}，否则称为{\heiti 非完整系统}。

根据前面对约束的分类，今后在研究质点系的运动时，我们只考虑完整系统，或者具有线性非完整约束的非完整系统。即系统的约束为
\begin{subnumcases}{}
	f_j(\mbf{r}_1,\mbf{r}_2,\cdots,\mbf{r}_n,t)=0,\quad j=1,2,\cdots,k \label{chapter2:完整约束的一般形式} \\
	\ds \sum_{i=1}^n \mbf{A}_{ji}(\mbf{r}_1,\mbf{r}_2,\cdots,\mbf{r}_n,t) \cdot \dot{\mbf{r}}_i + A_{j0}(\mbf{r}_1,\mbf{r}_2,\cdots,\mbf{r}_n,t)=0, \quad j=1,2,\cdots,k' \label{chapter2:非完整约束的一般形式}
\end{subnumcases}
在特殊情况下$k$和$k'$可以等于零。

如果在完整约束\eqref{chapter2:完整约束的一般形式}中不显含时间$t$，则该完整约束称为{\bf 定常的}或{\bf 稳定的}。如果在非完整约束\eqref{chapter2:非完整约束的一般形式}中矢量函数$\mbf{A}_{ji}$不显含时间$t$，而标量函数$A_{j0}$恒等于零，则该非完整约束称为{\bf 定常的}或{\bf 稳定的}。如果一个系统是自由的或者所有约束都是定常约束，则该系统称为{\bf 定常系统}，如果至少有一个约束是非定常的，则称为{\bf 非定常系统}。

\subsection{自由度}

体系可独立变动（并非取值）坐目标个数，即独立速度分量个数，称为体系的{\heiti 自由度}。

设某$n$质点体系具有完整约束
\begin{equation}
	f_j(\mbf{r}_1,\mbf{r}_2,\cdots,\mbf{r}_n;t) = 0,\quad j = 1,2,\cdots,k
\end{equation}
和非完整约束
\begin{equation}
	f_{j'}(\mbf{r}_1,\mbf{r}_2,\cdots,\mbf{r}_n;\dot{\mbf{r}}_1,\dot{\mbf{r}}_2,\cdots,\dot{\mbf{r}}_n;t) = 0,\quad j' = 1,2,\cdots,k'
\end{equation}
则体系的独立坐标数$s = 3n-k$，自由度$f = 3n-k-k'$。对于完整体系，$k'=0$，自由度与独立坐标数相等$f = s$。对于非完整体系，$k'>0$，则有$f < s$。

\subsection{广义坐标}

以双摆为例（如图\ref{双摆系统}所示），其约束为
\begin{equation*}
	\begin{cases}
		x_1^2 + y_1^2 - l_1^2 = 0 \\
		(x_2-x_1)^2 + (y_2-y_1)^2 - l_2^2 = 0
	\end{cases}
\end{equation*}
因此，体系的自由度为$2$，可以在四个坐标中任选独立的两个确定位形。但如此做并不方便，因此任选两个独立参量确定位形，如两个角度$(\theta_1,\theta_2)$，其转换关系为
\begin{equation*}
	\begin{cases}
		x_1 = l_1 \cos \theta_1 \\ 
		y_1 = l_1 \sin \theta_1 \\
		x_2 = l_1 \cos \theta_1 + l_2 \cos \theta_2 \\
		y_2 = l_1 \sin \theta_1 + l_2 \sin \theta_2 
	\end{cases}
\end{equation*}
\begin{figure}[htb]
\centering
\begin{asy}
	size(200);
	//双摆系统
	pair O,x,y,P1,P2;
	real theta1,theta2,l1,l2,r;
	O = (0,0);
	x = (4,0);
	y = (0,-4);
	l1 = 2;
	l2 = 3;
	theta1 = 30;
	theta2 = 50;
	draw(Label("$x$",EndPoint),O--x,Arrow);
	draw(Label("$y$",EndPoint),O--y,Arrow);
	P1 = l1*dir(theta1-90);
	P2 = P1 + l2*dir(theta2-90);
	r = 0.1;
	fill(shift(P1)*scale(r)*unitcircle,black);
	fill(shift(P2)*scale(r)*unitcircle,black);
	draw(Label("$l_1$",MidPoint,Relative(W)),O--P1);
	draw(Label("$l_2$",MidPoint,Relative(W)),P1--P2);
	draw(P1--P1+1.5*dir(-90),dashed);
	label("$\theta_1$",0.6*dir(theta1/2-90));
	label("$\theta_2$",P1+0.5*dir(theta2/2-90));
	label("$(x_1,y_1)$",P1,NE);
	label("$(x_2,y_2)$",P2+(0.1,0),E);
	
	//draw(O--(4.5,0),invisible);
\end{asy}
\caption{双摆系统}
\label{双摆系统}
\end{figure}

此处，确定力学体系位形的任意一组独立变量，称为{\heiti 广义坐标}。各质点坐标与广义坐标间的函数关系称为{\heiti 坐标变换方程}，其使得约束方程自动满足。广义坐目标引入使完整约束方程与不独立坐标一起消去。

广义坐目标特点：
\begin{enumerate}
	\item 可任选，一般要求相互独立，并能确定体系的位形；
	\item 不必具有长度量纲或明显的几何意义；
	\item 属于整个体系，而非个别质点，因而任一广义坐目标变化一般会引起全部质点的位移，反之亦然。
\end{enumerate}

由广义坐标张成的$s$维抽象空间，称为{\heiti 位形空间}。体系的位形及其随时间的演化分别对应该空间的一点与一条曲线。

\section{虚位移与约束力}

\subsection{虚位移}

实时的、约束允许的任意虚拟无限小位置变动，称为{\heiti 虚位移}，记作$\delta \mbf{r}$以区别于实位移$\mathrm{d} \mbf{r}$。力与虚位移之内积相应地称为{\heiti 虚功}。
\begin{figure}[htb]
\centering
\begin{asy}
	size(200);
	//约束在曲面上的质点
	pair A[],O,a,b,ns,g1,g2;
	O = (0,0);
	a = (2,0);
	b = (0.5,1);
	A[1] = O-a-b;
	A[2] = O+a-b;
	A[3] = O+a+b;
	A[4] = O-a+b;
	A[5] = (A[1]+A[2])/2+(0,0.3);
	A[6] = (A[2]+A[3])/2+(0,0.2);
	A[7] = (A[3]+A[4])/2+(0,0.3);
	A[8] = (A[4]+A[1])/2+(0,0.2);
	path surf,row,col;
	surf = A[1]..A[5]..A[2]--A[2]..A[6]..A[3]--A[3]..A[7]..A[4]--A[4]..A[8]..A[1]--cycle;
	ns = (A[5]+A[7])/2+(0,0.2);
	col = A[5]..ns..A[7];
	row = A[6]..ns..A[8];
	draw(surf);
	draw(row,dashed);
	draw(col,dashed);
	g1 = 1*dir(row,1);
	g2 = 0.6*dir(col,1);
	draw(ns-g1-g2--ns+g1-g2--ns+g1+g2--ns-g1+g2--cycle);
	draw(Label("$\boldsymbol{n}$",EndPoint),ns--ns+0.8*dir(90),Arrow);
	draw(Label("$\delta\boldsymbol{r}$",EndPoint),ns--ns+0.5*dir(30),red,Arrow);
	//draw(O--A[3]+(0.4,0),invisible);
\end{asy}
\caption{约束在曲面上的质点}
\label{约束在曲面上的质点}
\end{figure}

考虑于约束在曲面（曲面可移动，可变形）上运动的质点，曲面的方程表示为$f(\mbf{r},t)=0$，则$t$时刻该质点的位矢满足方程
\begin{equation*}
	f(\mbf{r},t) = 0
\end{equation*}
设质点具有虚位移$\delta \mbf{r}$则有\footnote{此处需考虑到虚位移是“实时”的无限小位置变动。}
\begin{equation*}
	f(\mbf{r}+\delta \mbf{r},t) = 0
\end{equation*}
所以
\begin{equation*}
	0 = f(\mbf{r}+\delta \mbf{r},t)-f(\mbf{r},t) = \frac{\pl f}{\pl \mbf{r}} \cdot \delta \mbf{r}
\end{equation*}
由于$\dfrac{\pl f}{\pl \mbf{r}} \parallel \mbf{n}$\footnote{此处，算符$\dfrac{\pl}{\pl \mbf{r}}$定义为\begin{equation*} \frac{\pl}{\pl \mbf{r}} = \mbf{e}_1 \frac{\pl}{\pl x}+\mbf{e}_2 \frac{\pl}{\pl y}+\mbf{e}_3 \frac{\pl}{\pl z} = \bnb \end{equation*}后文不再特别说明。}，所以有$\delta \mbf{r} \perp \mbf{n}$。此时虚位移即为质点所在处曲面切平面内的无限小位移。

对于实位移则有
\begin{equation*}
	\begin{cases}
		f(\mbf{r},t) = 0 \\
		f(\mbf{r}+\mathrm{d} \mbf{r},t+\mathrm{d} t) = 0
	\end{cases}
\end{equation*}
所以
\begin{equation*}
	0 = f(\mbf{r}+\mathrm{d} \mbf{r},t+\mathrm{d} t) - f(\mbf{r},t) = \frac{\pl f}{\pl \mbf{r}} \cdot \mathrm{d}\mbf{r} + \frac{\pl f}{\pl t} \mathrm{d} t
\end{equation*}
即有
\begin{equation*}
	\frac{\pl f}{\pl \mbf{r}} \cdot \mathrm{d} \mbf{r} = - \frac{\pl f}{\pl t} \mathrm{d} t
\end{equation*}
如果约束为{\heiti 稳定约束}（约束方程不显含时间），则有$\dfrac{\pl f}{\pl t} = 0$，所以
\begin{equation*}
	\frac{\pl f}{\pl \mbf{r}} \cdot \mathrm{d} \mbf{r} = 0
\end{equation*}
即$\mathrm{d} \mbf{r} \in \{\delta \mbf{r}\}$，实位移是全体虚位移中的一个。如果约束为{\heiti 不稳定约束}（约束方程显含时间），则有$\dfrac{\pl f}{\pl t} \neq 0$，所以
\begin{equation*}
	\frac{\pl f}{\pl \mbf{r}} \cdot \mathrm{d} \mbf{r} \neq 0
\end{equation*}
即$\mathrm{d} \mbf{r} \notin \{\delta \mbf{r}\}$，实位移不在虚位移集合中。

引入等时变分$\delta$运算，其运算规则等同于微分运算$\mathrm{d}$，但作用于时间时结果为零，即$\delta t=0$。考虑
\begin{equation*}
	\delta f = \frac{\pl f}{\pl \mbf{r}} \cdot \delta \mbf{r} + \frac{\pl f}{\pl t} \delta t = \frac{\pl f}{\pl \mbf{r}} \cdot \delta \mbf{r} = 0
\end{equation*}
可知，位矢的等时变分即为虚位移。

对于完整约束
\begin{equation*}
	f_j(\mbf{r}_1,\mbf{r}_2,\cdots,\mbf{r}_n;t) = 0,\quad j = 1,2,\cdots,k
\end{equation*}
则有
\begin{equation*}
	\delta f_j = \sum_{i=1}^n \frac{\pl f_j}{\pl \mbf{r}_i} \cdot \delta \mbf{r}_i = 0,\quad j = 1,2,\cdots,k
\end{equation*}
即各虚位移分量线性相关，$k$个方程共减少$k$独立分量。对于线性非完整约束（只含有速度一次项）
\begin{equation*}
	\sum_{i=1}^n \mbf{A}_{ji}(\mbf{r},t) \cdot \dot{\mbf{r}}_i + A_{j0}(\mbf{r},t) = 0,\quad j=1,2,\cdots,k'
\end{equation*}
或者
\begin{equation*}
	\sum_{i=1}^n \mbf{A}_{ji}(\mbf{r},t) \cdot \mathrm{d} \mbf{r}_i + A_{j0}(\mbf{r},t) \mathrm{d}t = 0,\quad j=1,2,\cdots,k'
\end{equation*}
则有
\begin{equation*}
	\sum_{i=1}^n \mbf{A}_{ji}(\mbf{r},t) \cdot \delta \mbf{r}_i = 0,\quad j=1,2,\cdots,k'
\end{equation*}
即$k'$个方程共减少$k'$个独立虚位移分量。因此，系统的独立虚位移分量（即坐标变分）数为$3n-k-k'=f$。体系自由度即等于独立坐标变分个数。

\subsection{约束力}

起约束作用的物体对被约束质点施加的作用力$\mbf{R}_i$称为{\heiti 约束力}，而体系质点除约束力之外的受力$\mbf{F}_i$称为{\heiti 主动力}。一般情况下，主动力是已知力，约束力是未知力，由主动力和质点运动情况决定。

约束力总虚功为零的约束称为{\heiti 理想约束}，下列几种常见的约束都是理想约束。
\begin{enumerate}
	\item 质点沿光滑曲面运动，如图\ref{质点沿光滑曲面运动约束}所示。此时约束力$\mbf{R}$沿曲面在该点的法线方向，而虚位移$\delta \mbf{r}$根据上节讨论则在切平面内，即有
	\begin{equation*}
		\mbf{R} \cdot \delta \mbf{r} = 0
	\end{equation*}
	\item 刚性联结的两质点（包括刚体中任意两点），如图\ref{刚性联结的两质点约束}所示。此时约束力$\mbf{R}_1$和$\mbf{R}_2$沿联结方向，根据Newton第三定律可有$\mbf{R}_2=-\mbf{R}_1$。考虑到
	\begin{equation*}
		\mbf{r}_{12} \cdot \mbf{r}_{12} = l^2
	\end{equation*}
	所以
	\begin{equation*}
		2\mbf{r}_{12} \cdot \delta \mbf{r}_{12} = 0
	\end{equation*}
	即有
	\begin{equation*}
		\mbf{R}_1 \cdot \delta \mbf{r}_1 + \mbf{R}_2 \cdot \delta \mbf{r}_2 = \mbf{R}_1 \cdot (\delta \mbf{r}_1 - \delta \mbf{r}_2) = \mbf{R}_1 \cdot \delta \mbf{r}_{12} = 0
	\end{equation*}
	此处考虑到了$\mbf{R}_1 \parallel \mbf{r}_{12}$。
	\item 两个物体以完全粗糙的表面相接触（不滑动，只能作纯滚动），如图\ref{两个物体以完全粗糙的表面相接触约束}所示。此时接触点上的约束力满足$\mbf{R}_2 =- \mbf{R}_1$，相对速度$\mbf{v}_2-\mbf{v}_1= \mbf{0}$，即有$\delta \mbf{r}_2-\delta \mbf{r}_1 = \mbf{0}$，因此
	\begin{equation*}
		\mbf{R}_1 \cdot \delta \mbf{r}_1 + \mbf{R}_2 \cdot \delta \mbf{r}_2 = \mbf{R}_1 \cdot (\delta \mbf{r}_1 - \delta \mbf{r}_2) = 0
	\end{equation*}
	\item 两个质点以柔软而不可伸长的绳子相联结，如图\ref{两个质点以柔软而不可伸长的绳子相联结约束}所示。此时约束力$\mbf{R}_1$和$\mbf{R}_2$都沿相应质点处的绳子方向，且大小相等记作$T$。将两个质点的虚位移$\delta \mbf{r}_1$和$\delta \mbf{r}_2$按沿绳和正交于绳的方向进行分解，将沿绳方向的虚位移记作$\delta \mbf{r}_1^\parallel = \delta l_1\mbf{e}_1$和$\delta \mbf{r}_2^\parallel = \delta l_2 \mbf{e}_2$。正交于绳方向的虚位移对应的虚功自然为零，考虑沿绳方向虚位移对应的虚功
	\begin{equation*}
		\mbf{R}_1 \cdot \delta \mbf{r}_1 + \mbf{R}_2 \cdot \delta \mbf{r}_2 = T\delta l_1 + T\delta l_2
	\end{equation*}
	由于绳不可伸长，所以有$\delta l_1 + \delta l_2 = 0$，故有
	\begin{equation*}
		\mbf{R}_1 \cdot \delta \mbf{r}_1 + \mbf{R}_2 \cdot \delta \mbf{r}_2 = \mbf{0}
	\end{equation*}
\end{enumerate}
\begin{figure}[htb]
\centering
\begin{minipage}[t]{0.45\textwidth}
\centering
\begin{asy}
	size(200);
	//质点沿光滑曲面运动约束
	pair O,A[],vec,P,tan;
	path surf;
	O = (0,0);
	A[1] = (-0.7,-1);
	A[2] = O;
	A[3] = (1.2,0.6);
	surf = A[1]..A[2]..A[3];
	draw(surf,linewidth(0.8bp));
	vec = 0.5*(0.1,-0.06);
	int imax=30;
	for(int i=1;i<imax;i=i+1){
		P = relpoint(surf,1./imax*i);
		draw(P--P+vec);
	}
	label("$P$",O+vec,SE);
	tan = 0.9*dir(surf,1);
	draw(Label("$\delta\boldsymbol{r}$",EndPoint),O--O+tan,Arrow);
	draw(Label("$\boldsymbol{R}$",EndPoint),O--O+rotate(90)*tan,Arrow);
	dot(O);
\end{asy}
\caption{质点沿光滑曲面运动}
\label{质点沿光滑曲面运动约束}
\end{minipage}
\hspace{1cm}
\begin{minipage}[t]{0.45\textwidth}
\centering
\begin{asy}
	size(200);
	//刚性联结的两质点约束
	pair O,P1,P2;
	O = (0,0);
	P1 = (0,1.5);
	P2 = (0.8,1);
	label("$O$",O,W);
	dot(P1);
	dot(P2);
	label("$P_1$",P1,N);
	label("$P_2$",P2,N);
	draw(Label("$\boldsymbol{r}_1$",MidPoint,Relative(W)),O--P1,Arrow);
	draw(Label("$\boldsymbol{r}_2$",MidPoint,Relative(E)),O--P2,Arrow);
	draw(Label("$\boldsymbol{r}$",MidPoint,Relative(W)),P2--P1,Arrow);
	draw(Label("$\boldsymbol{R}_1$",EndPoint),P1--interp(P1,P2,-0.6),Arrow);
	draw(Label("$\boldsymbol{R}_2$",EndPoint),P2--interp(P2,P1,-0.6),Arrow);
\end{asy}
\caption{刚性联结的两质点}
\label{刚性联结的两质点约束}
\end{minipage}
\hspace{0.4cm}

\begin{minipage}[t]{0.45\textwidth}
\centering
\begin{asy}
	size(200);
	//两个物体以完全粗糙的表面相接触约束
	pair O,O1,A[],B[],vec,P,Q,tan;
	O = (0,0);
	O1 = (2,0);
	A[1] = (0.2,0);
	A[2] = (0.3,0.1);
	A[3] = (0.5,0.6);
	A[4] = (1,0.8);
	A[5] = (1.7,0.3);
	A[6] = (1.65,0);
	path bodyA,bodyB;
	bodyA = A[1]..A[2]..A[3]..A[4]..A[5]..A[6];
	draw(bodyA,linewidth(0.8bp));
	draw(O--O1);
	int imax = 25;
	vec = 0.35*(-0.1,-0.2);
	for(int i=1;i<imax;i=i+1){
		P = interp(O,O1,1./imax*i);
		draw(P--P+vec);
	}
	P = relpoint(bodyA,0.65);
	tan = 0.5*reldir(bodyA,0.65);
	Q = P+0.7*(0.2,0.5);
	label("$P$",P,SW);
	draw(shift(Q)*scale(length(Q-P))*unitcircle,linewidth(0.8bp));
	draw(Label("$\delta \boldsymbol{r}_1$",EndPoint,NNE),P--P+tan,Arrow);
	draw(Label("$\delta \boldsymbol{r}_2$",EndPoint,S),P--P+tan,Arrow);
	draw(Label("$\boldsymbol{R}_1$",EndPoint),P--P-0.5*dir(80),Arrow);
	draw(Label("$\boldsymbol{R}_2$",EndPoint),P--P+0.5*dir(80),Arrow);
\end{asy}
\caption{两个物体以完全粗糙的表面相接触}
\label{两个物体以完全粗糙的表面相接触约束}
\end{minipage}
\hspace{1cm}
\begin{minipage}[t]{0.45\textwidth}
\centering
\begin{asy}
	size(200);
	//两个质点以柔软而不可伸长的绳子相联结约束
	pair O,P1,P2,tan1,tan2;
	real r,l1,l2;
	path cyl;
	O = (0,0);
	r = 0.2;
	cyl = shift(O)*scale(r)*unitcircle;
	filldraw(cyl,blue,black);
	P1 = relpoint(cyl,0.45);
	tan1 = reldir(cyl,0.45);
	P2 = relpoint(cyl,0.22);
	tan2 = -reldir(cyl,0.22);
	l1 = 1.5;
	l2 = 1.8;
	draw(P1--P1+l1*tan1);
	draw(P2--P2+l2*tan2);
	draw(Label("$\boldsymbol{R}_1$",EndPoint,E),P1+l1*tan1--P1+(l1-0.5)*tan1,Arrow);
	draw(Label("$\delta \boldsymbol{r}_1^\parallel$",EndPoint),P1+l1*tan1--P1+(l1+0.5)*tan1,Arrow);
	draw(Label("$\delta \boldsymbol{r}_1^\perp$",EndPoint),P1+l1*tan1--P1+l1*tan1+rotate(90)*0.5*tan1,Arrow);
	draw(Label("$\boldsymbol{R}_2$",EndPoint,N),P2+l2*tan2--P2+(l2-0.5)*tan2,Arrow);
	draw(Label("$\delta \boldsymbol{r}_2^\parallel$",EndPoint),P2+l2*tan2--P2+(l2+0.5)*tan2,Arrow);
	draw(Label("$\delta \boldsymbol{r}_2^\perp$",EndPoint),P2+l2*tan2--P2+l2*tan2+rotate(90)*0.5*tan2,Arrow);
	dot(P1+l1*tan1);
	dot(P2+l2*tan2);
\end{asy}
\caption{两个质点以柔软而不可伸长的绳子相联结}
\label{两个质点以柔软而不可伸长的绳子相联结约束}
\end{minipage}
\end{figure}

所有约束皆为理想约束的系统称为{\heiti 理想系统}，即理想系统需满足
\begin{equation*}
	\sum_{i=1}^n \mbf{R}_i \cdot \delta \mbf{r}_i = 0
\end{equation*}
对于非理想体系，可将摩擦力等虚功非零的约束力看作未知的主动力，而认为约束仍然是理想的，缺少的方程则由实验定律来补充。

下面可以看到，虚位移和虚功的引入将使未知的约束力自动消去。

\section{分析静力学的虚功原理}

\subsection{虚功原理}

如果理想体系处于静平衡状态，其中每个质点所受合力为零，即
\begin{equation*}
	\mbf{F}_i + \mbf{R}_i = \mbf{0},\quad i = 1,2,\cdots,n
\end{equation*}
由此可有
\begin{equation*}
	\sum_{i=1}^n (\mbf{F}_i+\mbf{R}_i) \cdot \delta \mbf{r}_i = 0
\end{equation*}
由于体系是理想的，故约束力的总虚功为零，由此可有
\begin{equation}
	\sum_{i=1}^n \mbf{F}_i \cdot \delta \mbf{r}_i = 0
	\label{虚功原理}
\end{equation}
式\eqref{虚功原理}表示的关系称为{\heiti 虚功原理}。即，平衡位形处，对任意虚位移，主动力的总虚功为零。

\subsection{广义虚位移和广义力}

约束\footnote{在静平衡条件下，所有的约束都是完整约束。}使得各质点的虚位移之间彼此不相互独立，设体系自由度为$s$，则可以引入$s$个广义坐标表征体系的位形，坐标转换关系表示为
\begin{equation}
	\mbf{r}_i = \mbf{r}_i(q_1,q_2,\cdots,q_s),\quad i = 1,2,\cdots,n
\end{equation}
由此可有
\begin{equation}
	\delta \mbf{r}_i = \sum_{\alpha=1}^s \frac{\pl \mbf{r}_i}{\pl q_\alpha} \delta q_\alpha
\end{equation}
此处$\delta q_\alpha$称为{\heiti 广义虚位移}。由此可有
\begin{equation*}
	\sum_{i=1}^n \mbf{F}_i \cdot \delta \mbf{r}_i = \sum_{\alpha=1}^s \left(\sum_{i=1}^n \mbf{F}_i \cdot \frac{\pl \mbf{r}_i}{\pl q_\alpha}\right)\delta q_\alpha
\end{equation*}
定义
\begin{equation}
	Q_\alpha = \sum_{i=1}^n \mbf{F}_i \cdot \frac{\pl \mbf{r}_i}{\pl q_\alpha}
\end{equation}
称为与广义坐标$q_\alpha$对应的广义主动力，则虚功原理可以用广义坐标表示为
\begin{equation}
	\sum_{i=1}^s Q_\alpha \delta q_\alpha = 0
	\label{虚功原理的广义表示}
\end{equation}

\subsection{完整系的平衡条件}

广义坐标使全部完整约束方程自动满足，所有广义坐标可以独立取值与变动，因此完整系的所有广义虚位移独立，因此由式\eqref{虚功原理的广义表示}可得完整系的平衡条件
\begin{equation}
	Q_\alpha\big|_{\mbf{q}_0} = 0,\quad \alpha =1,2,\cdots,s
\end{equation}
即，完整系平衡位形处，各广义主动力分量为零。

如果系统为保守体系，所有主动力均对应有势能
\begin{equation}
	\mbf{F}_i = -\frac{\pl V}{\pl \mbf{r}_i}(\mbf{r}_i),\quad i=1,2,\cdots,n
\end{equation}
则有
\begin{equation*}
	V = V(\mbf{r}(\mbf{q},t))
\end{equation*}
此时，广义主动力可以表示为
\begin{equation}
	Q_\alpha = -\sum_{i=1}^n \frac{\pl V}{\pl \mbf{r}_i} \cdot \frac{\pl \mbf{r}_i}{\pl q_\alpha} = -\frac{\pl V}{\pl q_\alpha}
\end{equation}
此时平衡条件可以表示为
\begin{equation}
	\frac{\pl V}{\pl q_\alpha}\bigg|_{\mbf{q}_0} = 0,\quad \alpha = 1,2,\cdots,s
\end{equation}
即完整保守体系在平衡位形处势能取驻值。可以证明，势能取极小值，平衡为{\heiti 稳定平衡}；势能取极大值，平衡为{\heiti 不稳定平衡}；势能取常数值，平衡为{\heiti 随遇平衡}。

\begin{example}
质量为$m$，固有半径为$a$，弹性系数为$k$的弹性圈置于半顶角$\alpha$的光滑直立圆锥上，求弹性圈的平衡半径与张力。\label{第二章例1}
\begin{figure}[htb]
\centering
\begin{asy}
	size(200);
	//第二章例1图
	pair O,x,y;
	real h,r,x0;
	O = (0,0);
	x = (1,0);
	y = (0,0.5);
	h = 1.7;
	r = 0.8;
	x0 = 0.6;
	draw(Label("$x$",EndPoint),-x--x,Arrow);
	draw(Label("$y$",EndPoint),(0,-h)--y,Arrow);
	draw(O--(r,-h)--(-r,-h)--cycle);
	label("$\alpha$",(0,-0.25*h),E);
	draw(interp(O,(-r,-h),x0)--interp(O,(r,-h),x0),red+linewidth(1bp));
	label("$x_0$",(0,-x0*h),SE);
	//draw(O--x+(0.3,0),invisible);
\end{asy}
\caption{例\theexample}
\label{第二章例1图}
\end{figure}
\end{example}
\begin{solution}
光滑锥面的完整约束为
\begin{equation*}
	y = -x\cot \alpha
\end{equation*}
主动力包括重力和弹性力，均为保守力。广义坐标取为$x$，则体系的势能表示为
\begin{equation*}
	V(x) = \frac12 k\left[2\pi(x-a)\right]^2 - mgx\cot \alpha
\end{equation*}
平衡条件为
\begin{equation*}
	\frac{\pl V}{\pl x}\bigg|_{x_0} = 4\pi^2k(x_0-a)-mg\cot\alpha = 0
\end{equation*}
解得平衡位置为
\begin{equation*}
	x_0 = a+\frac{mg\cot\alpha}{4\pi^2k}
\end{equation*}
平衡时的弹性力为
\begin{equation*}
	T = 2\pi k(x_0-a) = \frac{mg\cot \alpha}{2\pi}
\end{equation*}
\end{solution}

\begin{example}
重新设计例\ref{第二章例1}中旋转面的形状，使弹性圈可平衡于任意高度。
\end{example}
\begin{solution}
设旋转面由曲线$y=f(x)$绕$y$轴旋转形成，此时系统的势能
\begin{equation*}
	V(x) = \frac12 k\left[2\pi(x-a)\right]^2 + mgf(x)
\end{equation*}
随遇平衡要求$V(x) = \text{常数}$，即
\begin{equation*}
	\frac12 k\left[2\pi(x-a)\right]^2 + mgf(x) = C
\end{equation*}
由此有
\begin{equation*}
	f(x) = C-\frac{2\pi^2 k}{mg}(x-a)^2
\end{equation*}
\end{solution}

\begin{example}
将例\ref{第二章例1}中的弹性圈改为刚性圈，求其在圆锥面上平衡时的张力。
\end{example}
\begin{solution}
此问题有两个约束：约束$y=-x\cot\alpha$，约束力为正压力；约束$x=a$，约束力为张力。虚功原理只能求平衡位形，而不涉及约束力。

因此，此处解除第二个约束，将张力视为主动力。问题归结为已知平衡位形，求部分未知主动力。根据虚功原理，有
\begin{equation*}
	-T(2\pi \delta x) - mg\delta y = 0
\end{equation*}
根据约束，可有
\begin{equation*}
	\delta y = -\delta x \cot \alpha
\end{equation*}
所以有
\begin{equation*}
	(mg\cot \alpha - 2\pi T) \delta x = 0
\end{equation*}
$\delta x$是独立的广义虚位移，因此有
\begin{equation*}
	mg\cot \alpha - 2\pi T = 0
\end{equation*}
所以，张力为
\begin{equation*}
	T = \frac{mg\cot \alpha}{2\pi}
\end{equation*}
\end{solution}

\section{d'Alambert原理与Lagrange方程}

\subsection{d'Alambert原理}

对质点系中的每个质点应用Newton第二定律，可有
\begin{equation*}
	\mbf{F}_i + \mbf{R}_i = m_i \ddot{\mbf{r}}_i,\quad i=1,2,\cdots,n
\end{equation*}
将上式整理为
\begin{equation*}
	\mbf{F}_i + \mbf{R}_i - m_i \ddot{\mbf{r}}_i = \mbf{0},\quad i=1,2,\cdots,n
\end{equation*}
将上式中的$-m_i \ddot{\mbf{r}}_i$看作一个主动力，称为{\heiti d'Alambert惯性力}，即主动力、约束力与惯性力构成平衡力系\footnote{这种将动力学问题转化为静力学问题考虑的方法，称为{\heiti 动静法}。}，由此根据虚功原理可以得到
\begin{equation}
	\sum_{i=1}^n(\mbf{F}_i - m_i \ddot{\mbf{r}}_i) \cdot \delta \mbf{r}_i = 0
	\label{d'Alambert原理}
\end{equation}
式\eqref{d'Alambert原理}表示的关系称为{\heiti d'Alambert原理}。即理想力学体系的实际运动使任意虚位移下的主动力与惯性力的总虚功为零——此为与Newton定律等价的力学基本原理。

\subsection{理想完整系的Lagrange方程}

在理想完整体系中，质点位矢与广义坐标之间的坐标转换关系为
\begin{equation*}
	\mbf{r}_i = \mbf{r}_i(\mbf{q},t),\quad i=1,2,\cdots,n
\end{equation*}
所以
\begin{equation*}
	\delta \mbf{r}_i = \sum_{\alpha=1}^s \frac{\pl \mbf{r}_i}{\pl q_\alpha} \delta q_\alpha
\end{equation*}
质点的速度为
\begin{equation}
	\dot{\mbf{r}}_i = \sum_{\alpha=1}^s \frac{\pl \mbf{r}_i}{\pl q_\alpha} \dot{q}_\alpha + \frac{\pl \mbf{r}_i}{\pl t} = \dot{\mbf{r}}_i(\mbf{q},\dot{\mbf{q}},t)
	\label{质点的速度}
\end{equation}
式中，$\dot{q}_\alpha$称为{\heiti 广义速度}。在式\eqref{质点的速度}两端的微分，可得
\begin{align}
	\mathrm{d} \dot{\mbf{r}}_i & = \sum_{\alpha=1}^s \mathrm{d} \left(\frac{\pl \mbf{r}_i}{\pl q_\alpha}\right) \dot{q}_\alpha + \sum_{\alpha=1}^s \frac{\pl \mbf{r}_i}{\pl q_\alpha} \mathrm{d} \dot{q}_\alpha + \mathrm{d} \left(\frac{\pl \mbf{r}_i}{\pl t}\right) \nonumber \\
	& = \sum_{\alpha=1}^s \frac{\mathrm{d}}{\mathrm{d} t} \frac{\pl \mbf{r}_i}{\pl q_\alpha} \mathrm{d} q_\alpha + \sum_{\alpha=1}^s \frac{\pl \mbf{r}_i}{\pl q_\alpha} \mathrm{d} \dot{q}_\alpha + \frac{\mathrm{d}}{\mathrm{d} t} \frac{\pl \mbf{r}_i}{\pl t} \mathrm{d} t
	\label{经典Lagrange关系中间步骤1}
\end{align}
此处将$\mbf{q}$和$\dot{\mbf{q}}$作为相互独立的变量来处理。又考虑到$\dot{\mbf{r}}_i = \dot{\mbf{r}}_i(\mbf{q},\dot{\mbf{q}},t)$，其全微分为
\begin{equation}
	\mathrm{d} \dot{\mbf{r}}_i = \sum_{\alpha=1}^s \frac{\pl \dot{\mbf{r}}_i}{\pl q_\alpha} \mathrm{d} q_\alpha + \sum_{\alpha=1}^s \frac{\pl \dot{\mbf{r}}_i}{\pl \dot{q}_\alpha} \mathrm{d} \dot{q}_\alpha + \frac{\pl \dot{\mbf{r}}_i}{\pl t} \mathrm{d} t
	\label{经典Lagrange关系中间步骤2}
\end{equation}
对比式\eqref{经典Lagrange关系中间步骤1}和式\eqref{经典Lagrange关系中间步骤2}的各项可得如下的{\heiti 经典Lagrange关系}：
\begin{equation}
	\frac{\pl \dot{\mbf{r}}_i}{\pl \dot{q}_\alpha} = \frac{\pl \mbf{r}_i}{\pl q_\alpha},\quad \frac{\pl \dot{\mbf{r}}_i}{\pl q_\alpha} = \frac{\mathrm{d}}{\mathrm{d} t} \frac{\pl \mbf{r}_i}{\pl q_\alpha}
	\label{经典Lagrange关系}
\end{equation}
根据d'Alambert原理，可有
\begin{equation}
	\sum_{i=1}^n (\mbf{F}_i - m_i \ddot{\mbf{r}}_i) \cdot \delta \mbf{r}_i = \sum_{\alpha=1}^s \left[\sum_{i=1}^n (\mbf{F}_i - m_i \ddot{\mbf{r}}_i) \cdot \frac{\pl \mbf{r}_i}{\pl q_\alpha}\right] \delta q_\alpha
	\label{Lagrange方程中间结果}
\end{equation}
其中主动力满足关系$\mbf{F}_i = \mbf{F}_i(\mbf{r},\dot{\mbf{r}},t) = \mbf{F}_i(\mbf{r}(\mbf{q},t),\dot{\mbf{r}}(\mbf{q},\dot{\mbf{q}},t),t)$，因此式\eqref{Lagrange方程中间结果}的第一项即为广义力
\begin{equation*}
	Q_\alpha = \sum_{i=1}^n \mbf{F}_i \cdot \frac{\pl \mbf{r}_i}{\pl q_\alpha} = Q_\alpha(\mbf{q},\dot{\mbf{q}},t)
\end{equation*}
现在考虑式\eqref{Lagrange方程中间结果}的第二项
\begin{align*}
	\sum_{i=1}^n m_i \ddot{\mbf{r}}_i \cdot \frac{\pl \mbf{r}_i}{\pl q_\alpha} & = \frac{\mathrm{d}}{\mathrm{d} t} \left(\sum_{i=1}^n m_i\dot{\mbf{r}}_i \cdot \frac{\pl \mbf{r}_i}{\pl q_\alpha}\right) - \sum_{i=1}^n m_i \dot{\mbf{r}}_i \cdot \frac{\mathrm{d}}{\mathrm{d} t} \frac{\pl \mbf{r}_i}{\pl q_\alpha} \\
	& = \frac{\mathrm{d}}{\mathrm{d} t} \left(\sum_{i=1}^n m_i\dot{\mbf{r}}_i \cdot \frac{\pl \dot{\mbf{r}}_i}{\pl \dot{q}_\alpha}\right) - \sum_{i=1}^n m_i \dot{\mbf{r}}_i \cdot \frac{\pl \dot{\mbf{r}}_i}{\pl q_\alpha} \\
	& = \frac{\mathrm{d}}{\mathrm{d} t} \left(\sum_{i=1}^n \frac12 m_i\frac{\pl \dot{\mbf{r}}_i^2}{\pl \dot{q}_\alpha}\right) - \sum_{i=1}^n \frac12 m_i \frac{\pl \dot{\mbf{r}}_i^2}{\pl q_\alpha} \\
	& = \frac{\mathrm{d}}{\mathrm{d} t} \frac{\pl T}{\pl \dot{q}_\alpha} - \frac{\pl T}{\pl q_\alpha}
\end{align*}
式中应用了经典Lagrange关系\eqref{经典Lagrange关系}，而
\begin{equation*}
	T = \sum_{i=1}^n \frac12 m_i\frac{\pl \dot{\mbf{r}}_i^2}{\pl \dot{q}_\alpha} = T(\mbf{q},\dot{\mbf{q}},t)
\end{equation*}
为系统的总动能。由此d'Alambert原理式变为
\begin{equation*}
	\sum_{i=1}^n (\mbf{F}_i - m_i \ddot{\mbf{r}}_i) \cdot \delta \mbf{r}_i = \sum_{\alpha=1}^s \left(Q_\alpha+\frac{\pl T}{\pl q_\alpha} - \frac{\mathrm{d}}{\mathrm{d} t} \frac{\pl T}{\pl \dot{q}_\alpha}\right) \delta q_\alpha = 0
\end{equation*}
由于$\delta q_\alpha\,(\alpha = 1,2,\cdots,s)$相互独立，则有
\begin{equation}
	\frac{\mathrm{d}}{\mathrm{d} t} \frac{\pl T}{\pl \dot{q}_\alpha} - \frac{\pl T}{\pl q_\alpha} = Q_\alpha,\quad \alpha = 1,2,\cdots,s
	\label{理想完整系的Lagrange方程}
\end{equation}
式\eqref{理想完整系的Lagrange方程}即为理想完整系的Lagrange方程，其为$s$个广义坐标的二阶常微分方程组（约束力已经被消去）。

\subsection{理想完整系Lagrange方程的数学结构}

速度可以表示为
\begin{equation*}
	\dot{\mbf{r}}_i = \sum_{\alpha=1}^s \frac{\pl \mbf{r}_i}{\pl q_\alpha} \dot{q}_\alpha + \frac{\pl \mbf{r}_i}{\pl t}
\end{equation*}
由此，动能可以表示为
\begin{align*}
	T & = \sum_{i=1}^n \frac12 m_i \dot{\mbf{r}}_i \cdot \dot{\mbf{r}}_i = \sum_{i=1}^n \frac12 m_i \left(\sum_{\alpha=1}^s \frac{\pl \mbf{r}_i}{\pl q_\alpha} \dot{q}_\alpha + \frac{\pl \mbf{r}_i}{\pl t}\right) \cdot \left(\sum_{\beta=1}^s \frac{\pl \mbf{r}_i}{\pl q_\beta} \dot{q}_\beta + \frac{\pl \mbf{r}_i}{\pl t}\right) \\
	& = \frac12 \sum_{\alpha,\beta=1}^s \sum_{i=1}^n m_i \frac{\pl \mbf{r}_i}{\pl q_\alpha} \cdot \frac{\pl \mbf{r}_i}{\pl q_\beta} \dot{q}_\alpha \dot{q}_\beta + \sum_{\alpha=1}^s \sum_{i=1}^n m_i \frac{\pl \mbf{r}_i}{\pl q_\alpha} \cdot \frac{\pl \mbf{r}_i}{\pl t} \dot{q}_\alpha + \frac12 \sum_{i=1}^n m_i \left(\frac{\pl \mbf{r}_i}{\pl t}\right)^2 \\
	& = \frac12 \sum_{\alpha,\beta=1}^s M_{\alpha\beta}(\mbf{q},t) \dot{q}_\alpha \dot{q}_\beta + \sum_{\alpha=1}^s P_\alpha(\mbf{q},t) \dot{q}_\alpha + T_0(\mbf{q},t)
\end{align*}
其中
\begin{equation*}
	M_{\alpha\beta}(\mbf{q},t) = \sum_{i=1}^n m_i \frac{\pl \mbf{r}_i}{\pl q_\alpha} \cdot \frac{\pl \mbf{r}_i}{\pl q_\beta},\quad P_\alpha(\mbf{q},t) = \sum_{i=1}^n m_i \frac{\pl \mbf{r}_i}{\pl q_\alpha} \cdot \frac{\pl \mbf{r}_i}{\pl t},\quad T_0(\mbf{q},t) = \frac12 \sum_{i=1}^n m_i \left(\frac{\pl \mbf{r}_i}{\pl t}\right)^2
\end{equation*}
则可将动能$T$按广义速度的次数分为三项，即
\begin{equation}
	T = \frac12 \sum_{\alpha,\beta=1}^s M_{\alpha\beta}(\mbf{q},t) \dot{q}_\alpha \dot{q}_\beta + \sum_{\alpha=1}^s P_\alpha(\mbf{q},t) \dot{q}_\alpha + T_0(\mbf{q},t) = T_2 + T_1 + T_0
	\label{动能的数学结构}
\end{equation}
其中
\begin{align*}
	T_2 & = \frac12 \sum_{\alpha,\beta=1}^s M_{\alpha\beta}(\mbf{q},t) \dot{q}_\alpha \dot{q}_\beta \\
	T_1 & = \sum_{\alpha=1}^s P_\alpha(\mbf{q},t) \dot{q}_\alpha \\
	T_0 & = \frac12 \sum_{i=1}^n m_i \left(\frac{\pl \mbf{r}_i}{\pl t}\right)^2
\end{align*}
由此可有
\begin{equation*}
	\frac{\pl T}{\pl \dot{q}_\alpha} = \sum_{\beta=1}^s M_{\alpha\beta}(\mbf{q},t) \dot{q}_\beta + P_\alpha(\mbf{q},t)
\end{equation*}
即有
\begin{align*}
	\frac{\mathrm{d}}{\mathrm{d} t} \frac{\pl T}{\pl \dot{q}_\alpha} & = \sum_{\beta=1}^s M_{\alpha\beta} \ddot{q}_\beta + \sum_{\beta,\gamma=1}^s \frac{\pl M_{\alpha\beta}}{\pl q_\gamma} \dot{q}_\beta \dot{q}_\gamma + \sum_{\beta=1}^s \left(\frac{\pl M_{\alpha\beta}}{\pl t} + \frac{\pl P_\alpha}{\pl q_\beta}\right) \dot{q}_\beta + \frac{\pl P_\alpha}{\pl t}
\end{align*}
以及
\begin{align*}
	\frac{\pl T}{\pl q_\alpha} = \frac12 \sum_{\beta,\gamma=1}^s \frac{\pl M_{\beta\gamma}}{\pl q_\alpha} \dot{q}_\beta \dot{q}_\gamma + \sum_{\beta=1}^s \frac{\pl P_\beta}{\pl q_\alpha} \dot{q}_\beta + \frac{\pl T_0}{\pl q_\alpha}
\end{align*}

\subsection{有势系的Lagrange函数}

如果外力是有势力\footnote{保守力与有势力是不同的，考虑
\begin{equation*}
	\mathrm{d} V = \sum_{i=1}^n \frac{\pl V}{\pl \mbf{r}_i} \cdot \mathrm{d} \mbf{r}_i + \frac{\pl V}{\pl t}\mathrm{d} t
\end{equation*}
因此有
\begin{equation*}
	\sum_{i=1}^n \mbf{F}_i \cdot \mathrm{d} \mbf{r}_i = -\mathrm{d} V + \frac{\pl V}{\pl t}\mathrm{d} t
\end{equation*}
所以仅当势函数不显含时间$\dfrac{\pl V}{\pl t}=0$时，有势力才是保守力。}，即
\begin{equation*}
	\mbf{F}_i = -\frac{\pl V}{\pl \mbf{r}_i},\quad i = 1,2,\cdots,n
\end{equation*}
其中$V(\mbf{r},t)$为势函数。考虑$V = V(\mbf{r}(\mbf{q},t),t)$，可有
\begin{equation*}
	Q_\alpha = -\sum_{i=1}^n \frac{\pl V}{\pl \mbf{r}_i} \cdot \frac{\pl \mbf{r}_i}{\pl q_\alpha} = -\frac{\pl V}{\pl q_\alpha}
\end{equation*}
由此，定义
\begin{equation}
	L(\mbf{q},\dot{\mbf{q}},t) = T(\mbf{q},\dot{\mbf{q}},t) - V(\mbf{q},t)
	\label{Lagrange函数}
\end{equation}
则有{\heiti 理想完整有势系的Lagrange方程}
\begin{equation}
	\frac{\mathrm{d}}{\mathrm{d} t} \frac{\pl L}{\pl \dot{q}_\alpha} - \frac{\pl L}{\pl q_\alpha} = 0,\quad \alpha =1,2,\cdots,s
	\label{理想完整有势系的Lagrange方程}
\end{equation}
如果体系中部分主动力为有势力，则可将其势归入Lagrange函数$L$，非势力表示为广义力，则同样可有Lagrange方程
\begin{equation}
	\frac{\mathrm{d}}{\mathrm{d} t} \frac{\pl L}{\pl \dot{q}_\alpha} - \frac{\pl L}{\pl q_\alpha} = Q'_\alpha,\quad \alpha =1,2,\cdots,s
\end{equation}

\begin{example}
质量为$m$的质点被约束在一光滑的水平平台上运动，质点上系着一根长为$l$的轻绳，绳子穿过平台上的小孔$O$，另一端挂着另一个质量为$M$的质点，写出系统的运动方程。
\begin{figure}[htb]
\centering
\begin{asy}
	size(200);
	//第二章例3图
	pair O,a,b,m,M;
	real r;
	O = (0,0);
	a = (1.5,0);
	b = 0.8*dir(60);
	m = dir(30);
	M = (0,-1.5);
	r = 0.05;
	draw((O+a+b)--(O-a+b)--(O-a-b)--(O+a-b)--cycle);
	draw(O--0.6*a,dashed);
	draw(Label("$r$",MidPoint,Relative(W)),O--m);
	draw(O--(0,-b.y),dashed);
	draw((0,-b.y)--M);
	draw(Label("$z$",EndPoint),O--(0,1),Arrow);
	fill(shift(m)*scale(r)*unitcircle,black);
	label("$m$",m,E);
	fill(shift(M)*scale(r)*unitcircle,black);
	label("$M$",M,W);
	label("$\theta$",0.5*dir(15));
	unfill(scale(r)*unitcircle);
	draw(scale(r)*unitcircle);
	label("$O$",O,W);
\end{asy}
\caption{例\theexample}
\label{第二章例3图}
\end{figure}
\end{example}

\begin{solution}
广义坐标取为$r$和$\theta$，则有
\begin{equation*}
	T = \frac12 m(\dot{r}^2 + r^2 \dot{\theta}^2) + \frac12 M\dot{r}^2,\quad V = Mg(r-l)
\end{equation*}
Lagrange函数为
\begin{equation*}
	L(r,\theta;\dot{r},\dot{\theta};t) = \frac12 m(\dot{r}^2 + r^2 \dot{\theta}^2) + \frac12 M\dot{r}^2 - Mg(r-l)
\end{equation*}
计算
\begin{align*}
\begin{array}{ll}
	\dfrac{\pl L}{\pl \dot{r}} = (m+M) \dot{r}, & \dfrac{\pl L}{\pl \dot{\theta}} = mr^2 \dot{\theta} \\[1.5ex]
	\dfrac{\pl L}{\pl r} = mr\dot{\theta}^2 - Mg, & \dfrac{\pl L}{\pl \theta} = 0
\end{array}
\end{align*}
所以系统的运动方程为
\begin{equation*}
	\begin{cases}
		(m+M) \ddot{r} - mr\dot{\theta}^2 + Mg = 0 \\
		\dfrac{\mathrm{d}}{\mathrm{d} t}(mr^2 \dot{\theta}) = 0
	\end{cases}
\end{equation*}
\end{solution}

\section{广义势}

理想完整有势系的外力与速度无关，即
\begin{equation*}
	\mbf{F}_i(\mbf{r},t) = -\frac{\pl V}{\pl \mbf{r}_i}(\mbf{r}_i,t),\quad i=1,2,\cdots,n
\end{equation*}
此时系统存在相应的Lagrange函数。那么对于速度相关的外力，是否也存在类似的Lagrange函数？

\subsection{广义势}

如果质点系中的质点所受外力可以用标量函数$U(\mbf{r},\dot{\mbf{r}},t)$表示为\footnote{与$\dfrac{\pl}{\pl \mbf{r}}$的含义类似，此处$\dfrac{\pl}{\pl \dot{\mbf{r}}_i}$定义为\begin{equation*} \frac{\pl}{\pl \dot{\mbf{r}}_i} = \mbf{e}_1 \frac{\pl}{\pl \dot{x}_i} + \mbf{e}_2 \frac{\pl}{\pl \dot{y}_i} + \mbf{e}_3 \frac{\pl}{\pl \dot{z}_i} \end{equation*}}
\begin{equation}
	\mbf{F}_i = \frac{\mathrm{d}}{\mathrm{d} t} \frac{\pl U}{\pl \dot{\mbf{r}}_i} - \frac{\pl U}{\pl \mbf{r}_i},\quad i = 1,2,\cdots,n
	\label{广义势关系}
\end{equation}
则标量函数$U(\mbf{r},\dot{\mbf{r}},t)$称为体系的{\heiti 广义势}。

\subsection{广义势体系的Lagrange函数}

在广义坐标变换下，广义势函数满足
\begin{equation*}
	U = U(\mbf{r}(\mbf{q},t),\dot{\mbf{r}}(\mbf{q},\dot{\mbf{q}},t),t)
\end{equation*}
则广义力可以表示为
\begin{align}
	Q_\alpha & = \sum_{i=1}^n \left(\frac{\mathrm{d}}{\mathrm{d} t} \frac{\pl U}{\pl \dot{\mbf{r}}_i} - \frac{\pl U}{\pl \mbf{r}_i}\right) \cdot \frac{\pl \mbf{r}_i}{\pl q_\alpha} \nonumber \\
	& = \frac{\mathrm{d}}{\mathrm{d} t} \left(\sum_{i=1}^n \frac{\pl U}{\pl \dot{\mbf{r}}_i} \cdot \frac{\pl \mbf{r}_i}{\pl q_\alpha} \right) - \sum_{i=1}^n \left(\frac{\pl U}{\pl \dot{\mbf{r}}_i} \cdot \frac{\mathrm{d}}{\mathrm{d} t} \frac{\pl \mbf{r}_i}{\pl q_\alpha} + \frac{\pl U}{\pl \mbf{r}_i} \cdot \frac{\pl \mbf{r}_i}{\pl q_\alpha}\right) \nonumber \\
	& = \frac{\mathrm{d}}{\mathrm{d} t} \left(\sum_{i=1}^n \frac{\pl U}{\pl \dot{\mbf{r}}_i} \cdot \frac{\pl \dot{\mbf{r}}_i}{\pl \dot{q}_\alpha} \right) - \sum_{i=1}^n \left(\frac{\pl U}{\pl \dot{\mbf{r}}_i} \cdot \frac{\pl \dot{\mbf{r}}_i}{\pl q_\alpha} + \frac{\pl U}{\pl \mbf{r}_i} \cdot \frac{\pl \mbf{r}_i}{\pl q_\alpha}\right) \nonumber \\
	& = \frac{\mathrm{d}}{\mathrm{d} t} \frac{\pl U}{\pl \dot{q}_\alpha} - \frac{\pl U}{\pl q_\alpha}
	\label{广义势系统中的广义力}
\end{align}
式中利用了经典Lagrange关系\eqref{经典Lagrange关系}。由此可定义广义势系统的Lagrange函数
\begin{equation}
	L(\mbf{q},\dot{\mbf{q}},t) = T(\mbf{q},\dot{\mbf{q}},t) - U(\mbf{q},\dot{\mbf{q}},t)
\end{equation}
则系统的Lagrange方程与式\eqref{理想完整有势系的Lagrange方程}相同，即
\begin{equation}
	\frac{\mathrm{d}}{\mathrm{d}t} \frac{\pl L}{\pl \dot{q}_\alpha} - \frac{\pl L}{\pl q_\alpha} = 0,\quad \alpha = 1,2,\cdots,s
\end{equation}
考虑动能$\displaystyle T = \sum_{i=1}^n \frac12 m_i \dot{\mbf{r}}_i \cdot \dot{\mbf{r}}_i$满足
\begin{equation*}
	-m_i \ddot{\mbf{r}}_i = \frac{\mathrm{d}}{\mathrm{d} t} \frac{\pl (-T)}{\pl \dot{\mbf{r}}_i} - \frac{\pl (-T)}{\pl \mbf{r}_i}
\end{equation*}
即，惯性力的广义势是负动能。由此，Lagrange函数即（除负号）惯性力与主动力广义势能之和，又称为体系的{\heiti 动势}。

\subsection{电磁场中带电粒子的广义势能}

电磁场中的带电粒子受到Lorentz力，即
\begin{equation}
	\mbf{F} = e\mbf{E}(\mbf{r},t) + e\dot{\mbf{r}} \times \mbf{B}(\mbf{r},t)
\end{equation}
根据Maxwell方程组中的$\bnb \cdot \mbf{B} = 0$，可令
\begin{equation}
	\mbf{B} = \bnb \times \mbf{A}
	\label{磁矢势}
\end{equation}
此处，式\eqref{磁矢势}中的矢量函数$\mbf{A}(\mbf{r},t)$称为{\heiti 电磁场的矢势}。再根据Maxwell方程组中的$\displaystyle \bnb \times \mbf{E} = -\frac{\pl \mbf{B}}{\pl t}$，可得
\begin{equation*}
	\bnb \times \left(\mbf{E} + \frac{\pl \mbf{A}}{\pl t}\right) = 0
\end{equation*}
由此可令
\begin{equation}
	\mbf{E} = -\bnb \phi - \frac{\pl \mbf{A}}{\pl t}
	\label{电标势}
\end{equation}
此处，式\eqref{电标势}中的标量函数$\phi(\mbf{r},t)$称为{\heiti 电磁场的标势}。

由此，Lorentz力可以表示为
\begin{align}
	\mbf{F} & = e\left[-\bnb \phi - \frac{\pl \mbf{A}}{\pl t} + \dot{\mbf{r}} \times (\bnb \times \mbf{A})\right] = e\left[-\frac{\pl \phi}{\pl \mbf{r}} - \frac{\pl \mbf{A}}{\pl t} - \dot{\mbf{r}} \cdot \frac{\pl \mbf{A}}{\pl \mbf{r}} + \frac{\pl (\dot{\mbf{r}} \cdot \mbf{A})}{\pl \mbf{r}}\right] \nonumber \\
	& = e\left[-\frac{\pl \phi}{\pl \mbf{r}} - \frac{\mathrm{d} \mbf{A}}{\mathrm{d} t} + \frac{\pl (\dot{\mbf{r}} \cdot \mbf{A})}{\pl \mbf{r}}\right] \nonumber \\
	& = \frac{\mathrm{d}}{\mathrm{d} t} \frac{\pl (e\phi - e\dot{\mbf{r}}\cdot \mbf{A})}{\pl \dot{\mbf{r}}} - \frac{\pl (e\phi - e\dot{\mbf{r}}\cdot \mbf{A})}{\pl \mbf{r}}
\end{align}
由此，广义势为
\begin{equation}
	U = e(\phi - \mbf{A} \cdot \dot{\mbf{r}})
	\label{电磁场中带电粒子的广义势}
\end{equation}
在电磁场中运动的自由带电粒子的Lagrange函数为
\begin{equation}
	L(\mbf{r},\dot{\mbf{r}},t) = \frac12 m \dot{\mbf{r}}^2 + e\mbf{A}(\mbf{r},t) \cdot \dot{\mbf{r}} - e\phi(\mbf{r},t)
	\label{电磁场中点电粒子的Lagrange函数}
\end{equation}

\section{守恒定律}

\subsection{广义动量及其守恒定律}

定义与广义坐标$q_\alpha$共轭的{\heiti 广义动量}
\begin{equation}
	p_\alpha = \frac{\pl L}{\pl \dot{q}_\alpha}
	\label{广义动量定义}
\end{equation}
则理想完整有势系的Lagrange方程\eqref{理想完整有势系的Lagrange方程}变为
\begin{equation}
	\dot{p}_\alpha = \frac{\pl L}{\pl q_\alpha}
	\label{广义动量定理}
\end{equation}
式\eqref{广义动量定理}表示的关系称为{\heiti 广义动量定理}。

如果某体系的Lagrange函数不显含某个广义坐标，即
\begin{equation*}
	\frac{\pl L}{\pl q_\alpha} = 0
\end{equation*}
则称坐标$q_\alpha$为{\heiti 循环坐标}或{\heiti 可遗坐标}，根据广义动量定理\eqref{广义动量定理}，可有
\begin{equation}
	\dot{p}_\alpha = 0
\end{equation}
即，与循环坐标共轭的广义动量守恒。

\subsection{广义能量及其守恒定律}

考虑Lagrange函数$L = L(\mbf{q},\dot{\mbf{q}},t)$的时间导数
\begin{align}
	\frac{\mathrm{d} L}{\mathrm{d} t} & = \sum_{\alpha=1}^s \frac{\pl L}{\pl q_\alpha}\dot{q}_\alpha + \sum_{\alpha=1}^s \frac{\pl L}{\pl \dot{q}_\alpha} \ddot{q}_\alpha + \frac{\pl L}{\pl t} \nonumber \\ 
	& = \sum_{\alpha=1}^s \frac{\pl L}{\pl q_\alpha} \dot{q}_\alpha + \frac{\mathrm{d}}{\mathrm{d} t} \sum_{\alpha=1}^s \frac{\pl L}{\pl \dot{q}_\alpha} \dot{q}_\alpha - \sum_{i=1}^s \frac{\mathrm{d}}{\mathrm{d} t} \left(\frac{\pl L}{\pl \dot{q}_\alpha}\right) \dot{q}_\alpha + \frac{\pl L}{\pl t} \nonumber \\
	& = -\sum_{\alpha=1}^s \left[\frac{\mathrm{d}}{\mathrm{d} t} \left(\frac{\pl L}{\pl \dot{q}_\alpha}\right) - \frac{\pl L}{\pl q_\alpha}\right] \dot{q}_\alpha + \frac{\mathrm{d}}{\mathrm{d} t} \sum_{\alpha=1}^s \frac{\pl L}{\pl \dot{q}_\alpha} \dot{q}_\alpha + \frac{\pl L}{\pl t}
	\label{广义能量定理中间步骤}
\end{align}
利用理想完整有势系的Lagrange方程，式\eqref{广义能量定理中间步骤}中的第一项为零。由此可令
\begin{equation}
	H = \sum_{\alpha=1}^s \frac{\pl L}{\pl \dot{q}_\alpha} \dot{q}_\alpha - L
	\label{广义能量}
\end{equation}
称为{\heiti 广义能量}，由此式\eqref{广义能量定理中间步骤}化为
\begin{equation}
	\dot{H} = -\frac{\pl L}{\pl t}
	\label{广义能量定理}
\end{equation}
式\eqref{广义能量定理}表示的关系称为{\heiti 广义能量定理}。如果系统的Lagrange函数不显含时间，即
\begin{equation*}
	\frac{\pl L}{\pl t} = 0
\end{equation*}
则有
\begin{equation}
	\dot{H} = 0
\end{equation}
即，系统的广义能量守恒。

\subsection{广义能量的数学结构}\label{第二章：广义能量的数学结构}

\begin{theorem}[齐次函数的Euler定理]
\label{齐次函数的Euler定理}
如果$n$元函数$f(x_1,x_2,\cdots,x_n)$对$\forall \, \lambda \neq 0$满足
\begin{equation*}
	f(\lambda x_1,\lambda x_2,\cdots,\lambda x_n) = \lambda^m f(x_1,x_2,\cdots,x_n)
\end{equation*}
则称为$m$次{\heiti 齐次函数}。其满足
\begin{equation}
	\sum_{i=1}^n x_i \frac{\pl f}{\pl x_i} = mf(x_1,x_2,\cdots,x_n)
\end{equation}
\end{theorem}
\begin{proof}
将式
\begin{equation*}
	f(\lambda x_1,\lambda x_2,\cdots,\lambda x_n) = \lambda^m f(x_1,x_2,\cdots,x_n)
\end{equation*}
两端对$\lambda$求偏导数，可得
\begin{equation*}
	\sum_{i=1}^n x_i f'_i = m\lambda^{m-1} f(x_1,x_2,\cdots,x_n)
\end{equation*}
由此，令$\lambda = 1$，即得证齐次函数的Euler定理
\begin{equation*}
	\sum_{i=1}^n x_i \frac{\pl f}{\pl x_i} = mf(x_1,x_2,\cdots,x_n) \qedhere
\end{equation*}
\end{proof}

根据动能的表达式\eqref{动能的数学结构}，可有
\begin{equation*}
	L = T-V = T_2 + T_1 + (T_0 - V) = L_2 + L_1 + L_0
\end{equation*}
由此，根据广义速度$\dot{q}_\alpha$的次数，可将Lagrange函数$L$分为三项，即
\begin{align*}
	L_2 & = \frac12 \sum_{\alpha,\beta=1}^s M_{\alpha\beta}(\mbf{q},t) \dot{q}_\alpha \dot{q}_\beta \\
	L_1 & = \sum_{\alpha=1}^s P_\alpha(\mbf{q},t) \dot{q}_\alpha \\
	L_0 & = \frac12 \sum_{i=1}^n m_i \left(\frac{\pl \mbf{r}_i}{\pl t}\right)^2 - V
\end{align*}
显然，$L_2,L_1$分别为广义速度$\dot{q}_\alpha$的$2$次、$1$次齐次函数，根据Euler定理，它们满足
\begin{equation*}
	\sum_{\alpha=1}^s \dot{q}_\alpha \frac{\pl L_2}{\pl \dot{q}_\alpha} = 2L_2,\quad \sum_{\alpha=1}^s \dot{q}_\alpha \frac{\pl L_1}{\pl \dot{q}_\alpha} = L_1
\end{equation*}
因此，广义能量为
\begin{equation*}
	H = \sum_{\alpha=1}^s \frac{\pl L}{\pl \dot{q}_\alpha} \dot{q}_\alpha - L = 2L_2 + L_1 - (L_2+L_1+L_0) = L_2 - L_0 = T_2 - T_0 + V
\end{equation*}

对于完整稳定约束系统，即
\begin{equation*}
	\frac{\pl f_j}{\pl t} = 0,\quad f_j(\mbf{r}) = 0,\quad j = 1,2,\cdots,k
\end{equation*}
可根据约束取广义坐标$\mbf{r}_i = \mbf{r}_i(\mbf{q})$，此时即有
\begin{equation*}
	\frac{\pl \mbf{r}_i}{\pl t} = \mbf{0},\quad i = 1,2,\cdots,n
\end{equation*}
此时$T_1 = T_0 = 0,\, T = T_2$，所以
\begin{equation*}
	H = T+V
\end{equation*}
稳定约束力实功为零，因为实位移属于虚位移集合。即，对稳定约束体系，广义能量即惯性系内的体系总能量。

对于完整非稳定约束系统，此时广义坐标取为$\mbf{r}_i = \mbf{r}_i(\mbf{q},t)$，即有
\begin{equation*}
	\frac{\pl \mbf{r}_i}{\pl t} \neq \mbf{0},\quad i = 1,2,\cdots,n
\end{equation*}
此时有
\begin{equation*}
	H = T_2-T_0+V
\end{equation*}
记$T' = T_2$，$V'=V-T_0$分别为广义曲线坐标系的等效动能与势能，则有
\begin{equation*}
	H = T'+V'
\end{equation*}
即，对非稳定约束体系，广义能量即广义坐标系（如非惯性系）内的体系总能量。

\begin{example}
半径为$R$的光滑圆环以匀角速度$\mathnormal{\Omega}$绕铅直直径旋转。质量为$m$的质点穿在圆环上，求其平衡位置。
\begin{figure}[htb]
\centering
\begin{asy}
	size(200);
	//第二章例5图
	pair O;
	real R,r,theta;
	O = (0,0);
	R = 1;
	r = 0.05;
	theta = -30;
	draw(shift(O)*scale(R)*unitcircle,linewidth(1bp));
	draw(O--R*dir(0),dashed);
	draw(O--R*dir(theta));
	fill(shift(R*dir(theta))*scale(r)*unitcircle,black);
	draw(1.2*R*dir(-90)--1.4*R*dir(90),dashed);
	draw(shift(1.2*R*dir(90))*xscale(2)*arc(O,2*r,110,360+70),Arrow);
	label("$O$",O,W);
	draw(Label("$\theta$",MidPoint,Relative(E)),arc(O,0.2,-90,theta),Arrow);
	label("$m$",R*dir(theta),3*W);
	label("$\mathnormal{\Omega}$",1.2*R*dir(90)+4*r*dir(0),E);
\end{asy}
\caption{例\theexample}
\label{第二章例5图}
\end{figure}
\end{example}
\begin{solution}
选择$\theta$作为广义坐标，则体系的Lagrange函数为
\begin{equation*}
	L = \frac12 m(R^2 \mathnormal{\Omega}^2 \sin^2 \theta + R^2 \dot{\theta}^2) + mgR(1-\cos \theta)
\end{equation*}
Lagrange函数不显含时间，故广义能量守恒，即
\begin{equation*}
	H = \frac{\pl L}{\pl \dot{\theta}} \dot{\theta} - L = \frac12 mR^2 \dot{\theta}^2 - \frac12 mR^2 \mathnormal{\Omega}^2 \sin^2 \theta + mgR(1-\cos \theta) = H_0
\end{equation*}
根据此广义能量的数学结构，可得旋转系中的动能为
\begin{equation*}
	T' = \frac12 mR^2 \dot{\theta}^2
\end{equation*}
惯性离心力与重力总势能（等效势能）为
\begin{equation*}
	V' = -\frac12 mR^2 \mathnormal{\Omega}^2 \sin^2 \theta + mgR(1-\cos \theta)
\end{equation*}
体系的势能曲线如图\ref{第二章例5势能曲线}所示。
\begin{figure}[htb]
\centering
\begin{asy}
	size(300);
	//第二章例5势能曲线
	real Rg,scale;
	real f(real theta){
		return scale*(-0.5*Rg*(sin(theta))**2+1-cos(theta));
	}
	scale = 2.5;
	Rg = 0;
	draw(Label("$\theta$",EndPoint),(-3.5,0)--(3.5,0),Arrow);
	draw(Label("$V'$",EndPoint),(0,-0.5)--(0,f(pi)+0.4),Arrow);
	pair P;
	for(int i=1;i<=4;i=i+1){
		P = (0,f(pi)/4*i);
		draw((P-(0.1,0))--(P+(0.1,0)));
	}
	label("$mgR$",(0.1,f(pi)/2),E);
	draw(Label("$-\pi$",BeginPoint),(-pi,-0.1)--(-pi,0.1));
	draw(Label("$\pi$",BeginPoint),(pi,-0.1)--(pi,0.1));
	draw(graph(f,-pi,pi),linewidth(0.8bp));
	Rg = 0.5;
	draw(graph(f,-pi,pi),red+linewidth(0.8bp));
	Rg = 1;
	draw(graph(f,-pi,pi),yellow+linewidth(0.8bp));
	Rg = 2;
	draw(graph(f,-pi,pi),green+linewidth(0.8bp));
	
	pair A,B;
	A = (-3,0.4*f(pi));
	B = (-1,0.85*f(pi));
	real delta;
	delta = (B.y-A.y)/8;
	fill(shift((0.05,-0.05))*box(A,B),black);
	unfill(box(A,B));
	draw(box(A,B));
	label("$R\mathnormal{\Omega}^2/g = 0.0$",((A.x+B.x)/2,A.y)+(0,7*delta));
	label("$R\mathnormal{\Omega}^2/g = 0.5$",((A.x+B.x)/2,A.y)+(0,5*delta),red);
	label("$R\mathnormal{\Omega}^2/g = 1.0$",((A.x+B.x)/2,A.y)+(0,3*delta),yellow);
	label("$R\mathnormal{\Omega}^2/g = 2.0$",((A.x+B.x)/2,A.y)+(0,1*delta),green);
\end{asy}
\caption{势能曲线}
\label{第二章例5势能曲线}
\end{figure}

平衡位置需满足
\begin{equation*}
	\frac{\pl V'}{\pl \theta}\bigg|_{\theta_0} = -mR^2 \mathnormal{\Omega}^2 \sin \theta_0 \cos \theta_0 + mgR \sin \theta_0 = 0
\end{equation*}
平衡是否稳定需考察
\begin{equation*}
	\frac{\pl^2 V'}{\pl \theta^2}\bigg|_{\theta_0} = mgR\cos \theta_0 - mR^2 \mathnormal{\Omega}^2 (2\cos^2 \theta_0-1)
\end{equation*}

当$\displaystyle \mathnormal{\Omega}^2 < \frac{g}{R}$时，平衡位置为$\theta_0 = 0$和$\theta_0 = \pi$。当$\theta_0 = 0$时，
\begin{equation*}
	\frac{\pl^2 V'}{\pl \theta^2}\bigg|_{0} = mR^2 \left(\frac{g}{R} - \mathnormal{\Omega}^2\right) > 0
\end{equation*}
平衡是稳定的。当$\theta_0 = \pi$时，
\begin{equation*}
	\frac{\pl^2 V'}{\pl \theta^2}\bigg|_{\pi} = -mR^2 \left(\frac{g}{R} + \mathnormal{\Omega}^2\right) < 0
\end{equation*}
平衡是不稳定的。

当$\displaystyle \mathnormal{\Omega}^2 > \frac{g}{R}$时，平衡位置为$\theta_0 = 0$、$\displaystyle \theta_0 = \pm \arccos \frac{g}{R\mathnormal{\Omega}^2}$和$\theta_0 = \pi$。当$\theta_0 = 0$时，
\begin{equation*}
	\frac{\pl^2 V'}{\pl \theta^2}\bigg|_{0} = mR^2 \left(\frac{g}{R} - \mathnormal{\Omega}^2\right) < 0
\end{equation*}
平衡是不稳定的。当$\displaystyle \theta_0 = \pm \arccos \frac{g}{R\mathnormal{\Omega}^2}$时，
\begin{equation*}
	\frac{\pl^2 V'}{\pl \theta^2}\bigg|_{\pm \arccos \frac{g}{R\mathnormal{\Omega}^2}} = \frac{mR^2}{\mathnormal{\Omega}^2} \left(\mathnormal{\Omega}^4-\frac{g^2}{R^2}\right) > 0
\end{equation*}
平衡是稳定的。当$\theta_0 = \pi$时，
\begin{equation*}
	\frac{\pl^2 V'}{\pl \theta^2}\bigg|_{\pi} = -mR^2 \left(\frac{g}{R} + \mathnormal{\Omega}^2\right) < 0
\end{equation*}
平衡是不稳定的。
\end{solution}

\begin{example}[电磁场中自由带电粒子的动量、能量及其守恒定律]
设电磁场的标势和矢势分别为
\begin{equation*}
	\phi = \phi(\mbf{r},t),\quad \mbf{A} = \mbf{A}(\mbf{r},t)
\end{equation*}
则该电磁场中的自由粒子Lagrange函数为
\begin{equation}
	L = \frac12 m\dot{\mbf{r}}^2 + e \mbf{A} \cdot \dot{\mbf{r}} - e\phi
\end{equation}
因此其动量为
\begin{equation}
	\mbf{p} = \frac{\pl L}{\pl \dot{\mbf{r}}} = m\mbf{\dot{r}} + e\mbf{A}
\end{equation}
其中$m\dot{\mbf{r}}$可称为{\heiti 机械动量}，$e\mbf{A}$可称为{\heiti 电磁动量}。其能量为
\begin{equation}
	H = \frac{\pl L}{\pl \dot{\mbf{r}}} \cdot \dot{\mbf{r}} - L = L_2 - L_0 = \frac12 m\dot{\mbf{r}}^2 + e\phi
\end{equation}
其中$\dfrac12 m\dot{\mbf{r}}^2$可称为{\heiti 机械动能}，$e\phi$可称为{\heiti 电磁势能}。

\iffalse
对于均匀电磁场，此时标势和矢势与空间坐标无关\footnote{这里均匀电磁场并非指场变量$\mbf{E}$和$\mbf{B}$而是指标势和矢势在空间上是均匀的。如果场变量在空间上均匀，标势和矢势并不一定与空间坐标无关。此时有\begin{equation*} \mbf{E} = -\bnb \phi - \frac{\pl \mbf{A}}{\pl t} = - \frac{\pl \mbf{A}}{\pl t},\quad \mbf{B} = \bnb \times \mbf{A} = \mbf{0} \end{equation*}即空间中只存在均匀的时变电场，这可由场源的特定分布来实现。}，即
\begin{equation*}
	\phi = \phi(t),\quad \mbf{A} = \mbf{A}(t)
\end{equation*}
此时$\mbf{r}$为循环坐标，因此有
\begin{equation*}
	\dot{\mbf{p}} = \frac{\pl L}{\pl \mbf{r}} = \mbf{0}
\end{equation*}
粒子的动量守恒。\fi

对于稳恒电磁场，此时标势和矢势与时间无关，即
\begin{equation*}
	\phi = \phi(\mbf{r}),\quad \mbf{A} = \mbf{A}(\mbf{r})
\end{equation*}
此时Lagrange函数不显含时间，即
\begin{equation*}
	\dot{H} = \frac{\pl L}{\pl t} = 0
\end{equation*}
粒子的能量守恒。
\end{example}

\begin{example}[稳恒均匀电磁场中的自由带电粒子]
设空间中存在稳恒、均匀的电磁场$\mbf{E}$和$\mbf{B}$，取磁场方向为$z$方向，则可取
\begin{equation*}
	\mbf{A} = \frac12 B(-y\mbf{e}_x + x\mbf{e}_y) = \frac12 \mbf{B} \times \mbf{r},\quad \phi = -\mbf{E} \cdot \mbf{r}
\end{equation*}
此时，该粒子的Lagrange函数可表示为
\begin{equation*}
	L = \frac12 m\dot{\mbf{r}}^2 + \frac12 e\dot{\mbf{r}} \cdot (\mbf{B} \times \mbf{r}) + e\mbf{E} \cdot \mbf{r} = \frac12 m\dot{\mbf{r}}^2 + \frac12 e \mbf{r} \cdot (\dot{\mbf{r}} \times \mbf{B}) + e\mbf{E} \cdot \mbf{r} 
\end{equation*}
根据Lagrange方程，可得稳恒均匀电磁场中的自由带电粒子的运动微分方程为
\begin{equation*}
	m \ddot{\mbf{r}} = e\dot{\mbf{r}} \times \mbf{B} + e\mbf{E}
\end{equation*}
上式右端即为该粒子受到的Lorentz力。
\end{example}

\section{时空对称性与守恒量}

\subsection{时空对称性}

某物理定律或某体系的某物理量在某变换下形式或量值保持不变，则称该变换为{\heiti 对称变换}，此物理定律或物理量具有该变换下的{\heiti 对称性}（或称{\heiti 不变性}），该物理量则称为该体系的{\bf 守恒量}或{\bf 运动积分}。

Lagrange函数是决定体系力学性质的特征函数，其变换不变性又称为体系对称性。力学体系在时空变换下的对称性称为{\heiti 时空对称性}，包括
\begin{itemize}
	\item {\heiti 空间平移对称性}：体系作任意整体平移，Lagrange函数不变；
	\item {\heiti 空间转动对称性}：体系作任意整体转动，Lagrange函数不变；
	\item {\heiti 时间平移对称性}：体系时间作任意平移，Lagrange函数不变。
\end{itemize}

\subsection{动量、角动量与能量守恒}

\subsubsection{空间平移对称性与动量守恒}

在平移方向上取广义坐标$q_1$，满足
\begin{equation*}
	\frac{\pl \mbf{r}_i}{\pl q_1} = \mbf{e},i =1,2,\cdots,n
\end{equation*}
固定其它广义坐标，只改变广义坐标$q_1$，即令
\begin{equation*}
	\delta q_\alpha = 0 ,\quad \alpha = 2,3,\cdots,n
\end{equation*}
则有
\begin{equation*}
	\delta \mbf{r}_i = \sum_{\alpha=1}^s \frac{\pl \mbf{r}_i}{\pl q_\alpha} \delta q_\alpha = \delta q_1 \mbf{e},\quad i = 1,2,\cdots,n
\end{equation*}
因此，广义坐标$q_1$的变化将导致体系的整体平移。体系的Lagrange函数在平移变换下不变，因此Lagrange函数不显含$q_1$，即
\begin{equation*}
	\frac{\pl L}{\pl q_1} = 0
\end{equation*}
由广义动量定理，可有
\begin{equation*}
	\dot{p}_1 = \frac{\pl L}{\pl q_1} = 0
\end{equation*}
又考虑到
\begin{align*}
	p_1 & = \frac{\pl L}{\pl \dot{q}_1} = \frac{\pl T}{\pl \dot{q}_1} = \frac{\pl}{\pl \dot{q}_1} \sum_{i=1}^n \frac12 m_i \dot{\mbf{r}}_i \cdot \dot{\mbf{r}}_i = \sum_{i=1}^n m_i \dot{\mbf{r}}_i \cdot \frac{\pl \dot{\mbf{r}}_i}{\pl \dot{q}_1} \\
	& = \sum_{i=1}^n m_i \dot{\mbf{r}}_i \cdot \frac{\pl \mbf{r}_i}{\pl q_1} = \mbf{e} \cdot \mbf{p}
\end{align*}
由此，体系沿$\mbf{e}$方向平移对称，则体系总动量的$\mbf{e}$分量守恒。

空间平移对称性又称{\heiti 空间均匀性}，即绝对位置不可测。

\subsubsection{空间转动对称性与角动量守恒}

\begin{figure}[htb]
\centering
\begin{asy}
	size(200);
	//空间转动
	pair O,OO,R1,R2;
	real h,r,theta;
	path cir;
	O = (0,0);
	h = 2;
	r = 1;
	theta = -30;
	OO = rotate(theta)*(0,2);
	cir = shift(OO)*rotate(theta)*yscale(1/2)*scale(r)*unitcircle;
	draw(Label("$\boldsymbol{e}$",EndPoint),O--3/2*OO,Arrow);
	draw(cir);
	R1 = relpoint(cir,0.85);
	R2 = relpoint(cir,0.95);
	draw(R1--OO--R2);
	draw(Label("$\delta \boldsymbol{r}_i$",MidPoint,N),R1--R2,red,Arrow);
	draw(Label("$\boldsymbol{r}_i$",MidPoint,Relative(W)),O--R1,Arrow);
	draw(Label("$\boldsymbol{r}_i+\delta \boldsymbol{r}_i$",MidPoint,Relative(E)),O--R2,Arrow);
	label("$\delta q_1$",OO,5*dir((R1+R2)/2-OO));
	//draw(O--(2.1,0),invisible);
\end{asy}
\caption{空间转动}
\label{空间转动}
\end{figure}
在转动方向上取广义坐标$q_1$，满足
\begin{equation*}
	\frac{\pl \mbf{r}_i}{\pl q_1} = \mbf{e} \times \mbf{r}_i,i =1,2,\cdots,n
\end{equation*}
固定其它广义坐标，只改变广义坐标$q_1$，即令
\begin{equation*}
	\delta q_\alpha = 0 ,\quad \alpha = 2,3,\cdots,n
\end{equation*}
则有
\begin{equation*}
	\delta \mbf{r}_i = \sum_{\alpha=1}^s \frac{\pl \mbf{r}_i}{\pl q_\alpha} \delta q_\alpha = \delta q_1 \mbf{e} \times \mbf{r}_i,\quad i = 1,2,\cdots,n
\end{equation*}
因此，广义坐标$q_1$的变化将导致体系的整体转动。体系的Lagrange函数在转动变换下不变，因此Lagrange函数不显含$q_1$，即
\begin{equation*}
	\frac{\pl L}{\pl q_1} = 0
\end{equation*}
由广义动量定理，可有
\begin{equation*}
	\dot{p}_1 = \frac{\pl L}{\pl q_1} = 0
\end{equation*}
又考虑到
\begin{align*}
	p_1 & = \frac{\pl L}{\pl \dot{q}_1} = \frac{\pl T}{\pl \dot{q}_1} = \sum_{i=1}^n m_i \dot{\mbf{r}}_i \cdot \frac{\pl \mbf{r}_i}{\pl q_1} = \sum_{i=1}^n m_i\dot{\mbf{r}}_i \cdot (\mbf{e} \times \mbf{r}_i) \\
	& = \sum_{i=1}^n \mbf{e} \cdot (\mbf{r}_i \times m_i \dot{\mbf{r}}_i) = \mbf{e} \cdot \mbf{L}
\end{align*}
由此，体系绕$\mbf{e}$整体转动对称，则体系总角动量的$\mbf{e}$分量守恒。

空间转动对称性又称{\heiti 空间各项同性}，即绝对方向不可测。

\subsubsection{时间平移对称性与能量守恒}

体系的Lagrange函数在时间平移变换下不变，因此Lagrange函数不显含$t$，即
\begin{equation*}
	\frac{\pl L}{\pl t} = 0
\end{equation*}
由广义能量定理有
\begin{equation*}
	\dot{H} = -\frac{\pl L}{\pl t} = 0
\end{equation*}
由此，体系时间平移对称，则体系总能量守恒。

时间平移对称性又称{\heiti 时间均匀性}，即绝对时间不可测。

守恒定律与时空对称性有关，全部结论适用于整个物理学。循环坐标反映体系的对称性（变换不变性），可用其共轭动量守恒定律（只含广义速度和广义坐标）取代运动方程（含广义加速度）。对称性使体系的求解简化。

对称性是体系的客观属性，不依赖于主观描述。广义坐标选取适当，可使对称性通过循环坐标直观呈现。根据体系的对称性选择广义坐标，使循环坐标越多越好。

\begin{example}
自由质点受势场作用，场源均匀分布在以$z$轴为轴线、螺距为$h$的无限长圆柱螺旋线上。找出体系的守恒量。
\end{example}
\begin{solution}
选取广义坐标$(\rho,\phi,\zeta)$满足
\begin{equation*}
\begin{cases}
	x = \rho \cos \phi \\
	y = \rho \sin \phi \\
	z = \zeta + \dfrac{h\phi}{2\pi}
\end{cases}
\end{equation*}
此处，$\begin{cases} \rho = C_1 \\ \zeta = C_3 \end{cases}$表示的即为圆柱螺旋线族。此体系具有对称性：将质点沿任意螺距为$h$的螺旋线移动，Lagrange函数不变，即$\phi$为循环坐标，因此有
\begin{equation*}
	\dot{p}_\phi = \frac{\pl L}{\pl \phi} = 0
\end{equation*}
为了了解此处$p_\phi$的物理含义，考虑柱坐标系$(\rho,\psi,z)$，则广义坐标与柱坐标之间的关系为
\begin{equation*}
\begin{cases}
	\rho = \rho \\
	\psi = \phi \\
	z = \zeta + \dfrac{h\phi}{2\pi}
\end{cases}
\end{equation*}
如果取柱坐标$(\rho,\psi,z)$作为广义坐标，其与广义坐标共轭的广义动量物理意义比较清晰，即有
\begin{equation*}
	p_\psi = \frac{\pl L'}{\pl \dot{\psi}} = L_z,\quad p_z = \frac{\pl L'}{\pl \dot{z}}
\end{equation*}
此处$L_z$即为质点对$z$轴的角动量，$p_z$为沿$z$方向的动量。由此可有
\begin{equation*}
	p_\phi = \frac{\pl L}{\pl \dot{\phi}} = \frac{\pl L'}{\pl \dot{\psi}} \frac{\pl \dot{\psi}}{\pl \dot{\phi}} + \frac{\pl L'}{\pl \dot{z}} \frac{\pl \dot{z}}{\pl \dot{\phi}} = p_\psi + \frac{h}{2\pi} p_z = L_z + \frac{h}{2\pi} p_z
\end{equation*}
由此可得，此体系的守恒量为
\begin{equation*}
	p_\phi = L_z + \frac{h}{2\pi} p_z
\end{equation*}
\end{solution}

\section{位形时空的Lagrange方程}

\subsection{位形时空}

理想完整有势系的Lagrange方程
\begin{equation}
	\frac{\mathrm{d}}{\mathrm{d} t} \frac{\pl L}{\pl \dot{q}_\alpha} - \frac{\pl L}{\pl q_\alpha} = 0,\quad \alpha = 1,2,\cdots,s
\end{equation}
是$s$个二阶常微分方程构成的常微分方程组，给定$2s$个初始条件，即
\begin{equation*}
	\mbf{q}(t_0) = \mbf{q}_0,\quad \dot{\mbf{q}}(t_0) = \dot{\mbf{q}}_0
\end{equation*}
可以唯一确定位形空间轨道的参数方程
\begin{equation*}
	\mbf{q} = \mbf{q}(t)
\end{equation*}
此处，$t$为参数。另选参数$\tau$，将时间看作第$s+1$个广义坐标$q_{s+1}$，则$-H$即为与$q_{s+1}$共轭的广义动量$p_{s+1} = p_t = -H$。由此广义动量定理和广义能量定理将统一为
\begin{equation*}
	\dot{p}_\alpha = \frac{\pl L}{\pl q_\alpha},\quad \alpha = 1,2,\cdots,s,s+1
\end{equation*}

由广义坐标与时间张成的$s+1$维抽象空间称为{\heiti 位形时空}。位形时空中的点称为{\heiti 世界点}，代表体系的物理事件。世界点在位形时空运动而描出的轨道称为{\heiti 世界线}，反映体系物理过程的演化史。

\subsection{推广的Lagrange方程}

引入新的参数$\tau$，则有
\begin{equation*}
	\begin{cases}
		\mbf{q} = \mbf{q}(t(\tau)) \\
		t = t(\tau)
	\end{cases}
\end{equation*}
得到的对应Lagrange函数的状态函数可以表示为
\begin{equation*}
	\mathnormal{\Lambda} = \mathnormal{\Lambda}(\mbf{q},t;\mbf{q}',t';\tau)
\end{equation*}
由此可有关系\footnote{此处，用$t'$来表示$t$对$\tau$的导数，今后不再特别说明。}
\begin{align*}
	t' &= \frac{\mathrm{d} t}{\mathrm{d} \tau} \\
	\frac{\mathrm{d}}{\mathrm{d} \tau} & = \frac{\mathrm{d} t}{\mathrm{d} \tau} \frac{\mathrm{d}}{\mathrm{d} t} = t' \frac{\mathrm{d}}{\mathrm{d} t} \\
	\mbf{q}' &= \frac{\mathrm{d} \mbf{q}}{\mathrm{d} \tau} = \frac{\mathrm{d} t}{\mathrm{d} \tau} \frac{\mathrm{d} \mbf{q}}{\mathrm{d} t} = t' \dot{\mbf{q}}
\end{align*}
考虑
\begin{equation*}
	\mathrm{d} L = \sum_{\alpha=1}^s \frac{\pl L}{\pl q_\alpha} \mathrm{d} q_\alpha + \sum_{\alpha=1}^s \frac{\pl L}{\pl \dot{q}_\alpha} \mathrm{d} \dot{q}_\alpha + \frac{\pl L}{\pl t} \mathrm{d} t = \sum_{\alpha=1}^s \dot{p}_\alpha \mathrm{d} q_\alpha + \sum_{\alpha=1}^s p_\alpha \mathrm{d} \dot{q}_\alpha - \dot{H} \mathrm{d} t
\end{equation*}
可有
\begin{equation*}
	t'\mathrm{d} L = \sum_{\alpha=1}^s p'_\alpha \mathrm{d} q_\alpha + \sum_{\alpha=1}^s p_\alpha t' \mathrm{d} \dot{q}_\alpha - H' \mathrm{d} t
\end{equation*}
所以
\begin{align}
	\mathrm{d} (Lt') & = L\mathrm{d} t' + t'\mathrm{d} L = \sum_{\alpha=1}^s p'_\alpha \mathrm{d} q_\alpha - H' \mathrm{d} t + \sum_{\alpha=1}^s p_\alpha (\mathrm{d} q'_\alpha - \dot{q}_\alpha \mathrm{d} t') + L\mathrm{d} t' \nonumber \\
	& = \sum_{\alpha=1}^s p'_\alpha \mathrm{d} q_\alpha + p'_t \mathrm{d} t + \sum_{\alpha=1}^s p_\alpha t' \mathrm{d} q'_\alpha + p_t\mathrm{d} t'
	\label{推广的Lagrange函数中间步骤}
\end{align}
由此，定义
\begin{equation*}
	\mathnormal{\Lambda}(\mbf{q},t;\mbf{q}',t';\tau) = L \left(\mbf{q},\frac{\mbf{q}'}{t'},t\right) t'
\end{equation*}
求其全微分，可有
\begin{equation*}
	\mathrm{d} \mathnormal{\Lambda} = \sum_{\alpha=1}^s \frac{\pl \mathnormal{\Lambda}}{\pl q_\alpha} \mathrm{d} q_\alpha + \frac{\pl \mathnormal{\Lambda}}{\pl t} \mathrm{d} t + \sum_{\alpha=1}^s \frac{\pl \mathnormal{\Lambda}}{\pl q'_\alpha} \mathrm{d} q'_\alpha + \frac{\pl \mathnormal{\Lambda}}{\pl t'} \mathrm{d} t' + \frac{\pl \mathnormal{\Lambda}}{\pl \tau} \mathrm{d} \tau
\end{equation*}
将上式与\eqref{推广的Lagrange函数中间步骤}对比，可得
\begin{equation}
	\begin{cases}
		\displaystyle p_\alpha = \frac{\pl \mathnormal{\Lambda}}{\pl q'_\alpha},\quad p_t = \frac{\pl \mathnormal{\Lambda}}{\pl t'} \\[1.5ex]
		\displaystyle p'_\alpha = \frac{\pl \mathnormal{\Lambda}}{\pl q_\alpha},\quad p'_t = \frac{\pl \mathnormal{\Lambda}}{\pl t} \\[1.5ex]
		\displaystyle \frac{\pl \mathnormal{\Lambda}}{\pl \tau} = 0
	\end{cases}
	\label{位形时空的Lagrange方程中间步骤}
\end{equation}
消去式\eqref{位形时空的Lagrange方程中间步骤}中的广义动量，即可得到{\heiti 位形时空的Lagrange方程}
\begin{equation}
	\frac{\mathrm{d}}{\mathrm{d} \tau} \frac{\pl \mathnormal{\Lambda}}{\pl q'_\alpha} - \frac{\pl \mathnormal{\Lambda}}{\pl q_\alpha} = 0,\quad \alpha = 1,2,\cdots,s+1
	\label{位形时空的Lagrange方程}
\end{equation}
由此，$\mbf{q},t$统一为地位平等的坐标，$\mbf{p},H$统一为地位平等的动量，时间均匀性与空间均匀性得到统一。

这个过程对经典力学过渡为相对论力学具有启发性，有助于建立满足相对性原理（Lorentz变换不变性或对称性）的理论体系。时空作为统一体同时变换，时间不再具有绝对参数地位，需另选Lorentz变换下的不变量作为参数。此时$\mathnormal{\Lambda}$在Lorentz变换下不变即能保证体系满足相对性原理（惯性系变换对称性）。

\iffalse
这部分并不是完全基于上节内容，用有限的篇幅很难说清楚，故去掉。
\subsection{狭义相对论的分析力学形式}

狭义相对论下的变换应满足
\begin{equation*}
	\sum_{i=1}^3 \tilde{x}_i^2 - (c\tilde{t})^2 = \sum_{i=1}^3 x_i^2 - (ct)^2
\end{equation*}
取坐标系使得两参考系之间的相对速度方向为$x_1$轴方向，则有{\heiti Lorentz变换}
\begin{equation}
\begin{cases}
	\displaystyle \tilde{x}_1 = \frac{x_1 - Vt}{\sqrt{1-\dfrac{V^2}{c^2}}} \\[1.5ex]
	\tilde{x}_2 = x_2 \\[1.5ex]
	\tilde{x}_3 = x_3 \\[1.5ex]
	\displaystyle \tilde{t} = \frac{t - \dfrac{V}{c^2}x_1}{\sqrt{1-\dfrac{V^2}{c^2}}}
\end{cases}
\end{equation}\fi
