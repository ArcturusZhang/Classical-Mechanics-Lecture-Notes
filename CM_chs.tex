\documentclass[hyperref,UTF8,a4paper,openany]{ctexbook}
%\usepackage{ctex}
\usepackage{zhnumber}
\usepackage{graphicx}
\usepackage{subfigure}

\usepackage{latexsym}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{mathrsfs}
\usepackage{amsthm}
\usepackage{siunitx}

\usepackage{cases}

\usepackage{multirow}
\usepackage{textcomp}
\usepackage[top=2.54cm, bottom=2.54cm, left=3.18cm, right=3.18cm]{geometry}
\usepackage[toc]{multitoc}

\usepackage{asymptote}

%\usepackage{breqn}

\usepackage{hyperref}
\hypersetup{colorlinks,
        linkcolor=black,
        filecolor=black,
        urlcolor=blue,
        citecolor=black,
        pdftitle={《经典力学》讲稿},
        pdfauthor={张大鹏},
        pdfsubject={经典力学, 分析力学},
        pdfkeywords={经典力学, 分析力学},
        pdfproducer={XeLaTeX},
		pdfborder=0 0 1}

\setcounter{secnumdepth}{3} %使subsubsection也有编号

\usepackage{fancyhdr}	%页眉页脚

\usepackage{enumitem}
\setlist[description,1]{leftmargin=0pt,itemindent=2em}
\setlist[enumerate,1]{leftmargin=0pt,itemindent=2em}
\setlist[enumerate,2]{leftmargin=1em,itemindent=2em}
\setlist[enumerate,3]{leftmargin=1em,itemindent=2em}

\ctexset{figurename={\kaishu 图},
	tablename={表},
	contentsname={目\quad 录},
	listfigurename={插图目录}}
\newcommand{\eps}{\varepsilon}
\newcommand{\mbf}{\boldsymbol}
\newcommand{\mrm}[1]{\boldsymbol{\mathnormal{#1}}}
\newcommand{\bnb}{\mbf{\nabla}}
\newcommand{\pl}{\partial}
\newcommand{\arcosh}{\mathrm{arcosh}\,}
\newcommand{\sn}{\mathrm{sn}\,}
\newcommand{\cn}{\mathrm{cn}\,}
\newcommand{\tn}{\mathrm{tn}\,}
\newcommand{\dn}{\mathrm{dn}\,}
\newcommand{\am}{\mathrm{am}\,}
\renewcommand{\bf}{\heiti}
\renewcommand{\bfseries}{\heiti}

\newtheoremstyle{theoremwithoutdot}% 类型名
  {}%                   Space above, empty = `usual value'
  {}%                   Space below
  {\kaishu}%                   Body font
  {}%         Indent amount (empty = no indent, \parindent = para indent)
  {\heiti}%          Thm head font
  {}%                   Punctuation after thm head
  {1em}%                Space after thm head
  {\thmname{#1}\thmnumber{~#2}\thmnote{~(#3)}}%                   Thm head spec
  
 \newtheoremstyle{solutionstyle}% 类型名
  {}%                   Space above, empty = `usual value'
  {}%                   Space below
  {}%                   Body font
  {}%         Indent amount (empty = no indent, \parindent = para indent)
  {\heiti}%          Thm head font
  {}%                   Punctuation after thm head
  {1em}%                Space after thm head
  {\thmname{#1}\thmnumber{~#2}\thmnote{~(#3)}}%                   Thm head spec

\theoremstyle{theoremwithoutdot}
\newtheorem{defi}{定义}[section]
\newtheorem{theorem}{定理}[section]
\newtheorem{lemma}[theorem]{引理}
\newtheorem{prop}[theorem]{命题}
\newtheorem{coro}{推论}[theorem]
\newtheorem{remark}{注}
\newtheorem{example}{例}[chapter]
\newtheorem{question}{题}[section]
\newtheorem{property}[theorem]{性质}
%\renewcommand{\thequestion}{\arabic{chapter}.\arabic{section}.\arabic{question}}
\theoremstyle{solutionstyle}
\newtheorem*{solution}{解}
%去掉证明后面的点
\makeatletter
\renewenvironment{proof}[1][\proofname]{\par%
\pushQED{\qed}%
\normalfont \topsep6\p@\@plus6\p@\relax%
\trivlist%
\item[\hskip\labelsep%
#1]\ignorespaces%
}{%
\popQED\endtrivlist\@endpefalse%
}
\makeatother
\renewcommand{\proofname}{{\heiti 证明}}

%\renewcommand{\thefootnote}{\fnsymbol{footnote}}
%带圈脚注
\usepackage{pifont}
\usepackage[perpage,stable]{footmisc}  %每页脚注重新编号
\renewcommand{\thefootnote}{\ding{\numexpr191+\value{footnote}}}
% 脚注中的脚注序号不用上标，正文中的脚注号保持不变
\makeatletter
\def\my@makefnmark{\hbox{\normalfont\@thefnmark\space}}
\let\my@save@makefntext\@makefntext
\long\def\@makefntext#1{{%
  \let\@makefnmark\my@makefnmark
  \my@save@makefntext{#1}}}

\allowdisplaybreaks[3]

\title{《经典力学》讲义}
\author{徐晓华\\ 整理：张大鹏\thanks{有修改和删节。所有插图均为重新绘制。}\\ Email:\url{13110290004@fudan.edu.cn}}
%\date{}

\makeatletter
\def\cleardoublepage{\clearpage\if@twoside \ifodd\c@page\else
\hbox{}
\vspace*{\fill}

\vspace{\fill}
\thispagestyle{empty}
\newpage
\if@twocolumn\hbox{}\newpage\fi\fi\fi}
\makeatother

%在插图目录图编号前加上“图”
%\usepackage{titletoc}
%\titlecontents{figure}[0.5cm]{\songti}{\figurename~\thecontentslabel\quad}{\hspace*{-1.5cm}}{\titlerule*[0.12cm]{.}\contentspage}[\addvspace{6pt}]

%旧的样式
%\usepackage{titlesec}
%\titleformat{\section}{\bf \xiaosan}{\thesection}{1em}{}

%新的样式
\usepackage{titlesec}
\usepackage{xcolor,colortbl}
\usepackage{tgpagella}
\usepackage[T1]{fontenc}
 
\definecolor{titlecolor}{rgb}{0.503906,0.503906,0.734375}
%\definecolor{titlecolor}{RGB}{100,50,255}
\newcommand{\hwyk}{\heiti}
 
\newcommand{\mytitle}[1]{
\begin{tabular}{p{0.01\textwidth}p{0.99\textwidth}}
\cellcolor{black} &\cellcolor{titlecolor} \textcolor{white}
{\newline\hwyk\LARGE 第\zhnumber{\thechapter}章 \  \ #1}
\end{tabular}
\arrayrulewidth=0.4pt
}
 
\newcommand{\mycont}[1]{
\vspace{-0.5cm}
\begin{tabular}{p{0.01\textwidth}p{0.99\textwidth}}
\cellcolor{black} &\cellcolor{titlecolor} \textcolor{white}
{\newline\hwyk\LARGE #1}
\end{tabular}
\arrayrulewidth=0.4pt
\vspace{-2.0cm}
}
 
\newcommand{\mysection}[1]{
\setlength\arrayrulewidth{1pt}\arrayrulecolor{titlecolor}
\begin{tabular}{p{0.01\textwidth}p{0.99\textwidth}}
\hline
\cellcolor{titlecolor} &  \textcolor{black}{\hwyk\LARGE \thesection ~ #1}
\end{tabular}
\arrayrulewidth=0.4pt
\vspace{-0.7cm}
}

\newcommand{\mysubsection}[1]{
\setlength\arrayrulewidth{1pt}\arrayrulecolor{titlecolor}
\begin{tabular}{p{0.01\textwidth}p{0.99\textwidth}}
\hline
\cellcolor{titlecolor} &  \textcolor{black}{\hwyk\Large \thesubsection ~ #1} \\
\hline
\end{tabular}
\arrayrulewidth=0.4pt
\vspace{-0.5cm}
}

\newcommand{\mysubsubsection}[1]{
\setlength\arrayrulewidth{1pt}\arrayrulecolor{titlecolor}
\begin{tabular}{p{0.01\textwidth}p{0.95\textwidth}p{0.01\textwidth}}
\hline
\cellcolor{titlecolor} &  \textcolor{black}{\hwyk\Large \thesubsubsection ~ #1} & \cellcolor{titlecolor} \\
\hline
\end{tabular}
\arrayrulewidth=0.4pt
\vspace{-0.5cm}
}

\begin{document}

\maketitle

\frontmatter

\pagestyle{fancy}
\renewcommand{\chaptermark}[1]{\markboth{第\zhnumber{\thechapter}章\ \ #1}{}}
\renewcommand{\sectionmark}[1]{\markright{\thesection\ \ \rm #1}{}}	%这两个命令第一次必须出现在\pagestyle{fancy}之后，否则\pagestyle{fancy}会覆盖掉其效果
\markboth{\leftmark}{\rightmark}
\fancyhf{}
\fancyhead[CO]{\rightmark}
\fancyhead[LE,RO]{$\cdot$\, \thepage\, $\cdot$}
\fancyhead[CE]{\leftmark}
\renewcommand{\headrulewidth}{0.4pt}

\titleformat{\chapter}[hang]{\hwyk\LARGE}
{}{0mm}{\hspace{-0.4cm}\mycont}

\tableofcontents

\clearpage

\mainmatter
 
\titleformat{\chapter}[hang]{\hwyk\LARGE}
{}{0mm}{\hspace{-0.4cm}\mytitle}
 
\titleformat{\section}[hang]{\hwyk\LARGE}
{}{0mm}{\hspace{-0.5cm}\mysection}

\titleformat{\subsection}[hang]{\hwyk\large}
{}{0mm}{\hspace{-0.5cm}\mysubsection}

\titleformat{\subsubsection}[hang]{\hwyk\large}
{}{0mm}{\hspace{-0.5cm}\mysubsubsection}
 
\titlespacing{\chapter}
{0pc}{1.5ex plus .1ex minus .2ex}{.2pc}

%第零章——引言
\input{chapter/chapter0}

%第一章——牛顿力学
\input{chapter/chapter1}

%第二章——拉格朗日力学
\input{chapter/chapter2}

%第三章——哈密顿力学
\input{chapter/chapter3}

%第四章——两体问题
\input{chapter/chapter4}

%第五章——多自由度微振动与阻尼
\input{chapter/chapter5}

%第六章——刚体
\input{chapter/chapter6}

%第七章——非惯性系
\input{chapter/chapter7}

%附录——金尚年《经典力学》
\input{chapter/exercise}

%附录——理论力学习题集
\input{chapter/exercise2}

\backmatter

\addcontentsline{toc}{part}{\listfigurename}{%
\let\oldnumberline\numberline%
\renewcommand{\numberline}{\figurename~\oldnumberline}%
\listoffigures
}

%\listoffigures

%参考文献
\input{chapter/bibliography}

\end{document}
